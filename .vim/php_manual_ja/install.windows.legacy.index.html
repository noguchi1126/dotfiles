<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>古い Windows システムへのインストール</title>

 </head>
 <body><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="install.windows.troubleshooting.html">Windows 上での PHP のトラブルシューティング</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="install.cloud.html">クラウドコンピューティングプラットフォームへのインストール</a></div>
 <div class="up"><a href="install.windows.html">Windows システムへのインストール</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="install.windows.legacy.index" class="sect1">
    <h2 class="title">古い Windows システムへのインストール</h2>
   <p class="para">
    本章は、Windows 98/Me および Windows NT/2000/XP/2003 に適用されます。
    PHP は、Windows 3.1 などの 16 ビットのプラットフォームでは動作しません。
    PHP がサポートする Windows プラットフォーム を Win32 と呼ぶことがあります。
   </p>
   <blockquote class="note"><p><strong class="note">注意</strong>: 
    <p class="para">
     Windows XP/2003 は、PHP 5.5.0 以降サポートされなくなりました。
    </p>
   </p></blockquote>
   <blockquote class="note"><p><strong class="note">注意</strong>: 
    <p class="para">
     Windows 98/Me/NT4/2000 は、PHP 5.3.0 以降サポートされなくなりました。
    </p>
   </p></blockquote>
   <blockquote class="note"><p><strong class="note">注意</strong>: 
    <p class="para">
     Windows 95 は、PHP 4.3.0 以降サポートされなくなりました。
    </p>
   </p></blockquote>
   <p class="para">
    Microsoft Visual Studio などの開発環境を持っていれば、オリジナルのソースコードから
    PHP を  ビルドすることも可能です。
   </p>
   <p class="para">
    Windows システムに PHP をインストールした後、機能を追加するために
    <a href="install.windows.legacy.index.html#install.windows.legacy.extensions" class="link">拡張モジュールのロード</a>
    が必要な場合があります。
   </p>
   
   



   <div class="sect2" id="install.windows.legacy.manual">
    <h3 class="title">手動でのインストール</h3>
    <p class="para">
     この節では、Microsoft Windows 環境に
     PHP を手動でインストールして設定する方法を説明します。
    </p>
    <div class="sect3" id="install.windows.legacy.manual.download">
     <h4 class="title">PHP 配布パッケージの選択とダウンロード</h4>
     <p class="para">
      PHP バイナリの zip 版を
      <a href="http://windows.php.net/download/" class="link external">&raquo;&nbsp;PHP for Windows: Binaries and Sources</a>
      からダウンロードします。zip パッケージにはいくつかのバージョンがあります。
      適切なバージョンを選ぶための詳細な指針が、
      <a href="http://windows.php.net/download/" class="link external">&raquo;&nbsp;ダウンロードページ</a> にあるので、それに従いましょう。
     </p>
    </div>
    <div class="sect3" id="install.windows.legacy.manual.package">
     <h4 class="title">PHP パッケージの構造と内容</h4>
     <p class="para">
      zip パッケージを、たとえば C:\PHP\ などのお好みの場所に展開しましょう。
      zip を展開した中身は、次のようになります。
      <div class="example" id="install.unix.nginx.restart.nginx">
       <p><strong>例1 PHP 5 パッケージ構造</strong></p>
     <div class="example-contents">
<div class="cdata"><pre>

c:\php
   |
   +--dev
   |  |
   |  |-php5ts.lib                 -- 非スレッドセーフバージョンの場合は php5.lib
   |
   +--ext                          -- PHP 拡張モジュールの DLL
   |  |
   |  |-php_bz2.dll
   |  |
   |  |-php_cpdf.dll
   |  |
   |  |-...
   |
   +--extras                       -- 空
   |
   +--pear                         -- PEAR の初期コピー
   |
   |
   |-go-pear.bat                   -- PEAR セットアップ用スクリプト
   |
   |-...
   |
   |-php-cgi.exe                   -- CGI 実行ファイル
   |
   |-php-win.exe                   -- コマンドプロンプトを開かずにスクリプトを実行する
   |
   |-php.exe                       -- コマンドラインの PHP 実行ファイル (CLI)
   |
   |-...
   |
   |-php.ini-development           -- デフォルトの php.ini 設定
   |
   |-php.ini-production            -- 推奨される php.ini 設定
   |
   |-php5apache2_2.dll             -- 非スレッドセーフバージョンには存在しません
   |
   |-php5apache2_2_filter.dll      -- 非スレッドセーフバージョンには存在しません
   |
   |-...
   |
   |-php5ts.dll                    -- コア PHP DLL ( 非スレッドセーフバージョンの場合は php5.dll )
   | 
   |-...

</pre></div>
       </div>

      </div>
     </p>
     <p class="para">
      PHP の zip 版に含まれているモジュールや実行ファイルの一覧をまとめました。
      <ul class="itemizedlist">
       <li class="listitem">
        <p class="para">
         <var class="filename">go-pear.bat</var> - PEAR セットアップスクリプト。詳細は <a href="http://pear.php.net/manual/en/installation.php" class="link external">&raquo;&nbsp;Installation (PEAR)</a> を参照ください。
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         <var class="filename">php-cgi.exe</var> - CGI 実行ファイル。PHP を IIS 上で CGI あるいは FastCGI として実行するときに使います。
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         <var class="filename">php-win.exe</var> - PHP 実行ファイル。コマンドプロンプトを開かずに PHP スクリプトを実行します (Windows GUI を使う PHP アプリケーションなどに使います)。
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         <var class="filename">php.exe</var> - PHP 実行ファイル。PHP スクリプトをコマンドラインインターフェイス (CLI) で実行します。
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         <var class="filename">php5apache2_2.dll</var> - Apache 2.2.X モジュール。
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         <var class="filename">php5apache2_2_filter.dll</var> - Apache 2.2.X フィルタ。
        </p>
       </li>
      </ul>
     </p>
    </div>
    <div class="sect3" id="install.windows.legacy.manual.phpini">
     <h4 class="title"><var class="filename">php.ini</var> ファイルの変更</h4>
     <p class="para">
      php パッケージを展開したら、<var class="filename">php.ini-production</var> を
      <var class="filename">php.ini</var> という名前で同じフォルダにコピーします。
      必要に応じて <var class="filename">php.ini</var> を別の場所に置くこともできますが、
      その場合は <a href="configuration.file.html" class="link">PHP 設定ファイル</a>
      にあるような設定が別途必要となります。
     </p>
     <p class="para">
      <var class="filename">php.ini</var> ファイルには、PHP の設定や動作環境についての情報を記述します。
      <var class="filename">php.ini</var> ファイルには
      PHP を Windows 上で動かすための設定項目が数多く用意されています。
      その中には必須でないものもあります。
      また、環境に合わせて指定するディレクティブも数多くあります。詳細は
      <a href="ini.list.html" class="link">php.ini ディレクティブのリスト</a> を参照ください。
     </p>
     <p class="para">
      必須項目
      <ul class="itemizedlist">
       <li class="listitem">
        <p class="para">
         <var class="varname"><var class="varname">extension_dir</var></var> = <em>&lt;拡張モジュールのディレクトリへのパス&gt;</em> -
         <var class="varname"><var class="varname">extension_dir</var></var> には、
         PHP の拡張モジュールがあるディレクトリを指定しなければなりません。
         絶対パス (&quot;C:\PHP\ext&quot;) あるいは相対パス (i.e. &quot;.\ext&quot;)
         のどちらでもかまいません。<var class="filename">php.ini</var> ファイルに書かれている拡張モジュールは、
         <var class="varname"><var class="varname">extension_dir</var></var> に置かなければなりません。
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         <var class="varname"><var class="varname">extension</var></var> = <em>xxxxx.dll</em> -
         使いたい拡張モジュールがある場合は、それに対応する &quot;extension=&quot;
         を書かなければなりません。<var class="varname"><var class="varname">extension_dir</var></var>
         にある拡張モジュールのうち、ここで指定したものが起動時に読み込まれます。
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         <var class="varname"><var class="varname">log_errors</var></var> = <em>On</em> -
         PHP のログ出力機能を使うと、エラーをファイルに記録したり
         (syslog などの) サービスに渡したりすることができます。これは
         次の <var class="varname"><var class="varname">error_log</var></var> ディレクティブと組み合わせて使います。
         IIS で実行している場合は、<var class="varname"><var class="varname">log_errors</var></var>
         を有効にして <var class="varname"><var class="varname">error_log</var></var> を正しく設定しておく必要があります。
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         <var class="varname"><var class="varname">error_log</var></var> = <em>&lt;エラーログファイルへのパス&gt;</em> -
         error_log には、PHP のエラーを記録するファイルを絶対パスあるいは相対パスで指定しなければなりません。
         このファイルは、ウェブサーバーから書き込み可能でなければなりません。
         このファイルを置く場所として一般的なのは、たとえば
         &quot;C:\inetpub\temp\php-errors.log&quot; のような TEMP ディレクトリです。
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         <var class="varname"><var class="varname">cgi.force_redirect</var></var> = <em>0</em> -
         このディレクティブは、IIS で動かす際に必須となります。
         他の多くのウェブサーバーではディレクトリセキュリティ機能を必要としますが、
         これを IIS で有効にすると、Windows 上での PHP エンジンの実行に失敗します。
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         <var class="varname"><var class="varname">cgi.fix_pathinfo</var></var> = <em>1</em> -
         これは、CGI 仕様に従った path info に PHP からアクセスできるようにします。
         IIS の FastCGI 実装では、これを設定しておく必要があります。
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         <var class="varname"><var class="varname">fastcgi.impersonate</var></var> = <em>1</em> -
         IIS での FastCGI には、呼び出し元のクライアントのセキュリティトークンをまねる機能があります。
         これを指定すると、IIS にリクエストのセキュリティコンテキストを定義します。
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         <var class="varname"><var class="varname">fastcgi.logging</var></var> = <em>0</em> -
         FastCGI のログ機能は、IIS では無効にしておかねばなりません。
         有効にしたままだと、すべてのクラスから発せられるあらゆるメッセージが
         FastCGI のエラーとみなされ、IIS が HTTP 500 を返すようになってしまいます。
        </p>
       </li>
      </ul>
     </p>
     <p class="para">
      オプションの項目
      <ul class="itemizedlist">
       <li class="listitem">
        <p class="para">
         <var class="varname"><var class="varname">max_execution_time</var></var> = <em>##</em> -
         このディレクティブでは、スクリプトの実行に費やすことのできる最大時間を
         PHP に伝えます。デフォルトは 30 秒です。
         もし PHP アプリケーションの実行時間が長くなるのなら、このディレクティブの値を増やします。
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         <var class="varname"><var class="varname">memory_limit</var></var> = <em>###M</em> -
         PHP プロセスが使えるメモリの量をメガバイト単位で指定します。
         デフォルトは 128 で、たいていの PHP アプリケーションではこれで十分です。
         複雑なアプリケーションではもう少し必要となるかもしれません。
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         <var class="varname"><var class="varname">display_errors</var></var> = <em>Off</em> -
         このディレクティブは、ウェブサーバーに返すストリームに
         エラーメッセージを含めるかどうかを指定します。
         これを &quot;On&quot; にすると、<var class="varname"><var class="varname">error_reporting</var></var>
         で設定したすべてのレベルのエラーを
         エラーストリームの一部としてウェブサーバーに返します。
         セキュリティ上の理由で、実運用環境ではこれを &quot;Off&quot;
         にしておくことを推奨します。
         エラーメッセージにはセキュリティ的に問題となる情報が含まれていることが多く、
         それが外部に漏れることを防げます。
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         <var class="varname"><var class="varname">open_basedir</var></var> = <em>&lt;ディレクトリへのパス、セミコロン区切り&gt;</em>、
         たとえば openbasedir=&quot;C:\inetpub\wwwroot;C:\inetpub\temp&quot; -
         このディレクティブは、PHP からのファイルシステムの操作を許可するディレクトリのパスを指定します。
         指定したパス以外でのファイル操作はすべてエラーとなります。
         このディレクティブは、共用ホスティング環境に PHP を導入するときに特に有用です。
         ウェブサイトのルートディレクトリ以外のファイルを操作させないようにすることができます。
        </p>
       </li>
       <li class="listitem">
         <p class="para">
          <var class="varname"><var class="varname">upload_max_filesize</var></var> = <em>###M</em> および <var class="varname"><var class="varname">post_max_size</var></var> = <em>###M</em> -
          ファイルのアップロードおよび POST するデータの最大サイズを指定します。
          PHP のアプリケーションで写真や動画などの大きなファイルをアップロードさせたい場合は、
          これらの値を増やさなければなりません。
         </p>
        </li>
      </ul>
     </p>
    <p class="para">
     以上で、Windows への PHP のインストールが完了しました。ついで、
     使用する WEB サーバー にあわせて、PHP を利用可能とするための設定を行います。
     目次から使用する WEB サーバーを選択し、該当するセクションを参照してください。
    </p>
    <p class="para">
     PHP をウェブサーバー経由で実行するだけでなく、
     <em>.BAT</em> スクリプトなどでコマンドラインから実行することもできます。
     
    </p>
    </div>
   </div>



   



<div class="sect2" id="install.windows.legacy.iis">
 <h3 class="title">Microsoft IIS</h3>
 <p class="para">
  この節では、Microsoft Internet Information Services (IIS) への PHP のインストール手順について扱います。
 </p>
 <ul class="itemizedlist">
  <li class="listitem">
   <span class="simpara">
    <a href="install.windows.legacy.index.html#install.windows.legacy.iis6" class="link">Microsoft IIS 5.1 および IIS 6.0 への PHP の手動インストール</a>
   </span>
  </li>
  <li class="listitem">
   <span class="simpara">
    <a href="install.windows.legacy.index.html#install.windows.legacy.iis7" class="link">Microsoft IIS 7.0 以降への PHP の手動インストール</a>
   </span>
  </li>
 </ul>
</div>



   




<div class="sect2" id="install.windows.legacy.iis6">
 <h3 class="title">Microsoft IIS 5.1 および IIS 6.0</h3>
 <p class="para">
  この節では、Internet Information
  Services (IIS) 5.1 および IIS 6.0 を手動で設定して、PHP を
  Microsoft Windows XP および Windows Server 2003 で動かす方法を説明します。
  IIS 7.0 以降のバージョンを Windows
  Vista, Windows Server 2008, Windows 7 そして Windows Server 2008 R2
  で動かす方法については
  <a href="install.windows.legacy.index.html#install.windows.legacy.iis7" class="link">Microsoft IIS 7.0 以降</a>
  を参照ください。
 </p>
 <div class="sect3" id="install.windows.legacy.iis6.fastcgi">
  <h4 class="title">IIS で PHP リクエストを処理するための設定</h4>
  <p class="para">
    <a href="install.windows.legacy.index.html#install.windows.legacy.manual" class="link">手動インストールの手順</a>
    での説明にしたがって、PHP をダウンロードしてインストールします。
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <p class="para">
      IIS を使う場合は、非スレッドセーフ版の PHP を推奨します。非スレッドセーフ版は
      <a href="http://windows.php.net/download/" class="link external">&raquo;&nbsp;PHP for Windows: 
      Binaries and Sources Releases.</a> で取得できます。
     </p>
    </p></blockquote>
  </p>
  <p class="para">
   CGI や FastCGI 固有の設定を、<var class="filename">php.ini</var> で以下のように行います。
   <div class="example" id="install.unix.nginx.test.nginx.php">
    <p><strong>例2 <var class="filename">php.ini</var> での CGI および FastCGI 用の設定</strong></p>
    <div class="example-contents">
<div class="inicode"><pre class="inicode">fastcgi.impersonate = 1
fastcgi.logging = 0
cgi.fix_pathinfo=1
cgi.force_redirect = 0</pre>
</div>
    </div>

   </div>
  </p>
  <p class="para">
   <a href="http://www.iis.net/extensions/fastcgi" class="link external">&raquo;&nbsp;Microsoft FastCGI Extension for IIS 5.1 and 6.0</a>
   をダウンロードしてインストールします。32 ビット版と 64 ビット版があるので、
   環境にあわせて適切なパッケージを選びましょう。
  </p>
  <p class="para">
   FastCGI エクステンションを設定し、PHP のリクエストを処理できるようにするには
   以下のコマンドを実行します。&quot;-path&quot; パラメータの値は、
   <var class="filename">php-cgi.exe</var> の絶対パスに置き換えましょう。
   <div class="example" id="example-12">
    <p><strong>例3 FastCGI エクステンションで PHP リクエストを処理するための設定</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
cscript %windir%\system32\inetsrv\fcgiconfig.js -add -section:&quot;PHP&quot; ^
-extension:php -path:&quot;C:\PHP\php-cgi.exe&quot;
</pre></div>
    </div>

   </div>
  </p>
  <p class="para">
   このコマンドは、拡張子 *.php 用の IIS スクリプトマッピングを作成します。
   .php で終わるすべての URL を FastCGI エクステンションで処理するようになります。
   また、FastCGI エクステンションでの PHP リクエストの処理に
   <var class="filename">php-cgi.exe</var> を使うよう設定しています。
   <blockquote class="note"><p><strong class="note">注意</strong>: 
     <p class="para">
      この時点で、最低限必要なインストールと設定は完了しました。
      これ以降の手順は必須ではありませんが、IIS 上で PHP
      を効果的に動かすために強く推奨するものです。
     </p>
   </p></blockquote>
  </p>
 </div>
 <div class="sect3" id="install.windows.legacy.iis6.impersonation">
  <h4 class="title">匿名化およびファイルシステムへのアクセス</h4>
  <p class="para">
   PHP を IIS で使う場合は、FastCGI の匿名化を有効にしておくことを推奨します。
   これは、<var class="filename">php.ini</var> ファイルの
   <var class="varname"><var class="varname">fastcgi.impersonate</var></var> ディレクティブで設定します。
   匿名化を有効にすると、PHP はすべてのファイルシステム操作を
   IIS 認証で定義したユーザーアカウントで行います。
   こうしておけば、同じ PHP プロセスを異なる IIS ウェブサイトで共有している場合でも
   (各サイトで IIS 認証のユーザーアカウントを分けておけば)
   一方の PHP スクリプトからもう一方のファイルはアクセスできなくなります。
  </p>
  <p class="para">
   IIS 5.1 や IIS 6.0 のデフォルト設定では組み込みのユーザーアカウント
   IUSR_&lt;MACHINE_NAME&gt; による匿名認証が有効になっています。
   つまり、IIS で PHP スクリプトを実行する場合は IUSR_&lt;MACHINE_NAME&gt;
   アカウントにスクリプトの読み込み権限を付与しなければならないということです。
   PHP のアプリケーションからファイルへの書き込みやフォルダ内でのファイルの作成などをする場合は、
   IUSR_&lt;MACHINE_NAME&gt; アカウントに書き込み権限が必要となります。
  </p>
  <p class="para">
   IIS 匿名認証で使うユーザーアカウントを設定するには、次のようにします。
   <div class="procedure">
    <ol type="1"><li>
     <p class="simpara">Windows のスタートメニューで &quot;ファイル名を指定して実行&quot; を選び、&quot;inetmgr&quot;
     と入力して &quot;Ok&quot; をクリックする</p>
    </li>
    <li>
     <p class="simpara">ツリービューの &quot;Web Sites&quot; ノードにあるウェブサイトの一覧を展開し、
      使うウェブサイトの上で右クリックして &quot;プロパティ&quot; を選択する
     </p>    
    </li>
    <li>
     <p class="simpara">&quot;ディレクトリセキュリティ&quot; タブを選択する</p>    
    </li>
    <li>
     <p class="simpara">&quot;Authentication Methods&quot; ダイアログの &quot;User name:&quot; フィールドで設定</p>
    </li>
   </ol></div>
   <div class="mediaobject">
    
    <div class="imageobject">
     <img src="images/b4cf2bb34e3c20eebcf8f9e8e7949efd-iis6anonauth.png" alt="IIS 5.1 および IIS 6.0 の匿名認証" width="654" height="461" />
    </div>
   </div>
  </p>
  <p class="para">
   ファイルやフォルダのパーミッションを変更するには、エクスプローラあるいは
   <var class="varname"><var class="varname">icacls</var></var> コマンドを使います。
   <div class="example" id="example-13">
    <p><strong>例4 ファイルのアクセス権の設定</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
icacls C:\inetpub\wwwroot\upload /grant IUSR:(OI)(CI)(M)
</pre></div>     
    </div>

   </div>
  </p>
 </div>
 <div class="sect3" id="install.windows.legacy.iis6.defaultdoc">
  <h4 class="title">IIS のデフォルトドキュメントを <var class="filename">index.php</var> にする</h4>
  <p class="para">
   ドキュメント名を指定しない HTTP リクエストを受け取ったときには、
   IIS のデフォルトドキュメントが使われます。PHP アプリケーションでは、通常は
   <var class="filename">index.php</var> をデフォルトドキュメントとします。
   <var class="filename">index.php</var> を IIS のデフォルトドキュメントに追加するには、
   次のようにします。
   <div class="procedure">
    <ol type="1"><li>
     <p class="simpara">Windows のスタートメニューで &quot;ファイル名を指定して実行&quot; を選び、&quot;inetmgr&quot;
     と入力して &quot;Ok&quot; をクリックする</p>
    </li>
    <li>
     <p class="simpara">ツリービューの &quot;Web Sites&quot; ノードを右クリックして &quot;プロパティ&quot; を選択する</p>
    </li>
    <li>
     <p class="simpara">&quot;Documents&quot; タブをクリックする</p>
    </li>
    <li>
     <p class="simpara">&quot;Add...&quot; ボタンをクリックし、&quot;Default content page:&quot; に &quot;index.php&quot; を入力する</p>
    </li>
   </ol></div>
   <div class="mediaobject">
    
    <div class="imageobject">
     <img src="images/b4cf2bb34e3c20eebcf8f9e8e7949efd-iis6defaultdoc.png" alt="index.php を IIS のデフォルトドキュメントにする" width="659" height="465" />
    </div>
   </div>
  </p>
 </div>
 <div class="sect3" id="install.windows.legacy.iis6.recycling">
  <h4 class="title">FastCGI および PHP の再利用設定</h4>
  <p class="para">
   IIS FastCGI エクステンションで PHP プロセスの再利用を設定するには以下のコマンドを使います。
   FastCGI の設定項目 <var class="varname"><var class="varname">instanceMaxRequests</var></var> は、
   ひとつの <var class="filename">php-cgi.exe</var> が何回リクエストを処理すると
   FastCGI エクステンションがシャットダウンさせるかを表します。
   PHP の環境変数 <var class="varname"><var class="varname">PHP_FCGI_MAX_REQUESTS</var></var> は、
   ひとつの <var class="filename">php-cgi.exe</var> プロセスが何回リクエストを処理すると
   自分をリサイクルするかを表します。
   FastCGI の <var class="varname"><var class="varname">InstanceMaxRequests</var></var>
   で設定した値が <var class="varname"><var class="varname">PHP_FCGI_MAX_REQUESTS</var></var>
   以下になるようにしましょう。
   <div class="example" id="example-14">
    <p><strong>例5 FastCGI と PHP の再利用設定</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
cscript %windir%\system32\inetsrv\fcgiconfig.js -set -section:&quot;PHP&quot; ^
-InstanceMaxRequests:10000

cscript %windir%\system32\inetsrv\fcgiconfig.js -set -section:&quot;PHP&quot; ^
-EnvironmentVars:PHP_FCGI_MAX_REQUESTS:10000
</pre></div>     
    </div>

   </div>
  </p>
 </div>
 <div class="sect3" id="install.windows.legacy.iis6.timeouts">
  <h4 class="title">FastCGI のタイムアウト設定</h4>
  <p class="para">
   実行時間が長くなる PHP スクリプトがある場合は、FastCGI
   エクステンションのタイムアウト設定を増やします。タイムアウトに関連する設定項目は
   <var class="varname"><var class="varname">ActivityTimeout</var></var> と <var class="varname"><var class="varname">RequestTimeout</var></var> です。
   これらの設定に関する詳細は
   <a href="http://learn.iis.net/page.aspx/248/configuring-fastcgi-extension-for-iis-60/" class="link external">&raquo;&nbsp;Configuring FastCGI Extension for IIS 6.0</a>
   を参照ください。
   <div class="example" id="install.unix.litespeed.extract.php">
    <p><strong>例6 FastCGI のタイムアウト設定</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
cscript %windir%\system32\inetsrv\fcgiconfig.js -set -section:&quot;PHP&quot; ^
-ActivityTimeout:90

cscript %windir%\system32\inetsrv\fcgiconfig.js -set -section:&quot;PHP&quot; ^
-RequestTimeout:90
</pre></div>     
    </div>

   </div>
   </p>
 </div>
 <div class="sect3" id="install.windows.legacy.iis6.phpinilocation">
  <h4 class="title"><var class="filename">php.ini</var> ファイルの場所の変更</h4>
  <p class="para">
   PHP が <var class="filename">php.ini</var> ファイルを探す場所は
   <a href="configuration.file.html" class="link">いくつかあり</a>、
   <var class="filename">php.ini</var> ファイルのデフォルトの場所を
   環境変数 <var class="varname"><var class="varname">PHPRC</var></var> で変更することができます。
   特定の場所においた設定ファイルを PHP に読み込ませたい場合は、
   以下のコマンドを実行します。環境変数 <var class="varname"><var class="varname">PHPRC</var></var>
   には、<var class="filename">php.ini</var>
   ファイルがあるディレクトリへの絶対パスを指定しなければなりません。
   <div class="example" id="install.unix.litespeed.build.php">
    <p><strong>例7 <var class="filename">php.ini</var> ファイルの場所の変更</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
cscript %windir%\system32\inetsrv\fcgiconfig.js -set -section:&quot;PHP&quot; ^
-EnvironmentVars:PHPRC:&quot;C:\Some\Directory\&quot;
</pre></div>         
    </div>

   </div>
  </p>
 </div>
</div>



   




<div class="sect2" id="install.windows.legacy.iis7">
 <h3 class="title">Microsoft IIS 7.0 以降</h3>
 <p class="para">
  このセクションでは、Internet Information
  Services (IIS) 7.0 以降を設定して、PHP を Microsoft Windows Vista SP1,
  Windows 7, Windows Server 2008 および Windows Server 2008 R2 で動かす方法を説明します。
  IIS 5.1 や IIS 6.0 を Windows XP および Windows Server 2003 で動かす方法については
  <a href="install.windows.legacy.index.html#install.windows.legacy.iis6" class="link">Microsoft IIS 5.1 および IIS 6.0</a>
  を参照ください。
 </p>
 <div class="sect3" id="install.windows.legacy.iis7.fastcgi.enable">
  <h4 class="title">IIS での FastCGI サポートの有効化</h4>
  <p class="para">
   FastCGI モジュールは、IIS のデフォルトでは無効になっています。
   有効化する手順は、Windows のバージョンによって異なります。
  </p>
  <p class="para">
   Windows Vista SP1 および Windows 7 で FastCGI サポートを有効化する方法
   <div class="procedure">
    <ol type="1"><li>
     <p class="simpara">
      Windows のスタートメニューで &quot;ファイル名を指定して実行&quot; を選び、
      &quot;optionalfeatures.exe&quot; と入力して &quot;Ok&quot; をクリックする
     </p>
    </li>
    <li>
     <p class="simpara">
      &quot;Windows Features&quot; ダイアログで &quot;Internet Information 
      Services&quot;、&quot;World Wide Web Services&quot;、&quot;Application Development 
      Features&quot; を展開し、&quot;CGI&quot; チェックボックスを有効にする
     </p>
    </li>
    <li>
     <p class="simpara">
      OK をクリックし、インストールが完了するまで待つ
     </p>
    </li>
   </ol></div>
   <div class="mediaobject">
    
    <div class="imageobject">
     <img src="images/b4cf2bb34e3c20eebcf8f9e8e7949efd-iis7vistacgi.png" alt="Windows Vista SP1 および Windows 7 での FastCGI サポートの有効化" width="429" height="375" />
    </div>
   </div>
  </p>
  <p class="para">
   Windows Server 2008 および Windows Server 2008 R2 で FastCGI サポートを有効化する方法
   <div class="procedure">
    <ol type="1"><li>
     <p class="simpara">
      Windows のスタートメニューで &quot;ファイル名を指定して実行&quot; を選び、
      &quot;CompMgmtLauncher&quot; と入力して &quot;Ok&quot; をクリックする
     </p>
    </li>
    <li>
     <p class="simpara">
      &quot;Web Server (IIS)&quot; ロールが &quot;Roles&quot; ノードの下に存在しない場合は
      &quot;Add Roles&quot; をクリックして追加する
     </p>
    </li>
    <li>
     <p class="simpara">
      &quot;Web Server (IIS)&quot; ロールが存在する場合は、&quot;Add Role Services&quot;
      をクリックして &quot;Application Development&quot; グループの
      &quot;CGI&quot; チェックボックスを有効にする
     </p>
    </li>
    <li>
     <p class="simpara">
      &quot;Next&quot;、そして &quot;Install&quot; をクリックし、
      インストールが完了するまで待つ
     </p>
    </li>
   </ol></div>
   <div class="mediaobject">
    
    <div class="imageobject">
     <img src="images/b4cf2bb34e3c20eebcf8f9e8e7949efd-iis7w2k8cgi.png" alt="Windows Server 2008 および Windows Server 2008 R2 での FastCGI サポートの有効化" width="546" height="411" />
    </div>
   </div>
  </p>
 </div>
 <div class="sect3" id="install.windows.legacy.iis7.fastcgi.conf">
  <h4 class="title">IIS で PHP リクエストを処理するための設定</h4>
  <p class="para">
    <a href="install.windows.legacy.index.html#install.windows.legacy.manual" class="link">手動インストールの手順</a>
    での説明にしたがって、PHP をダウンロードしてインストールします。
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <p class="para">
      IIS を使う場合は、非スレッドセーフ版の PHP を推奨します。非スレッドセーフ版は
      <a href="http://windows.php.net/download/" class="link external">&raquo;&nbsp;PHP for Windows: 
      Binaries and Sources Releases.</a> で取得できます。
     </p>
    </p></blockquote>
  </p>
  <p class="para">
   CGI や FastCGI 固有の設定を、<var class="filename">php.ini</var> で以下のように行います。
   <div class="example" id="install.unix.openbsd.ports.example">
    <p><strong>例8 <var class="filename">php.ini</var> での CGI および FastCGI 用の設定</strong></p>
    <div class="example-contents">
<div class="inicode"><pre class="inicode">fastcgi.impersonate = 1
fastcgi.logging = 0
cgi.fix_pathinfo=1
cgi.force_redirect = 0</pre>
</div>
    </div>

   </div>
  </p>
  <p class="para">
   PHP 用の IIS ハンドラマッピングを設定するには IIS マネージャのユーザーインターフェイス
   あるいはコマンドラインツールを使います。
  </p>
  <div class="sect4" id="install.windows.legacy.iis7.fastcgi.conf.ui">
   <h5 class="title">IIS マネージャのユーザーインターフェイスを使った PHP 用ハンドラマッピングの作成</h5>
    <p class="para">
     PHP 用の IIS ハンドラマッピングを
     IIS マネージャのユーザーインターフェイスで設定する手順は次のとおりです。
     <div class="procedure">
      <ol type="1"><li>
       <p class="simpara">Windows のスタートメニューで &quot;ファイル名を指定して実行&quot; を選び、&quot;inetmgr&quot; と入力して &quot;Ok&quot; をクリックする</p>
      </li>
      <li>
       <p class="simpara">IIS マネージャのユーザーインターフェイスで、&quot;Connections&quot; ツリービューのサーバーノードを選ぶ</p>
      </li>
      <li>
       <p class="para">
        &quot;Features View&quot; ページで &quot;Handler Mappings&quot; を開く
        <div class="mediaobject">
         
         <div class="imageobject">
          <img src="images/b4cf2bb34e3c20eebcf8f9e8e7949efd-iis7handlericon.png" alt="PHP 用の IIS ハンドラマッピングの作成 : ハンドラマッピングの場所" width="708" height="515" />
         </div>
        </div>
       </p>
      </li>
      <li>
       <p class="simpara">&quot;Actions&quot; ペインで &quot;Add Module Mapping...&quot; をクリックする</p>
      </li>
      <li>
       <p class="para">
        &quot;Add Module Mapping&quot; ダイアログで次のように入力する
        <ul class="itemizedlist">
         <li class="listitem">
          <span class="simpara">Request path: *.php</span>
         </li>
         <li class="listitem">
          <span class="simpara">Module: FastCgiModule</span>
         </li>
         <li class="listitem">
          <span class="simpara">Executable: C:\[PHP をインストールしたパス]\php-cgi.exe</span>
         </li>
         <li class="listitem">
          <span class="simpara">Name: PHP_via_FastCGI</span>
         </li>
        </ul>
       </p>
      </li>
      <li>
       <p class="simpara">
        &quot;Request Restrictions&quot; ボタンをクリックし、
        リクエストがファイルあるいはフォルダにマップされたときだけハンドラが起動するように設定する
        </p>
      </li>
      <li>
       <p class="simpara">すべてのダイアログで OK をクリックし、設定を保存する</p>
      </li>
     </ol></div>
     <div class="mediaobject">
      
      <div class="imageobject">
       <img src="images/b4cf2bb34e3c20eebcf8f9e8e7949efd-iis7handlermap.png" alt="PHP 用の IIS ハンドラマッピングの作成 : ハンドラマッピングの追加" width="705" height="512" />
      </div>
     </div>
    </p>
  </div>
  <div class="sect4" id="install.windows.legacy.iis7.fastcgi.conf.cmd">
   <h5 class="title">コマンドラインツールによる PHP 用ハンドラマッピングの作成</h5>
   <p class="para">
    次のコマンドを使うと、IIS FastCGI プロセスプールを作ることができます。
    PHP リクエストの処理には <var class="filename">php-cgi.exe</var> を使います。
    <var class="varname"><var class="varname">fullPath</var></var> パラメータの値は
    <var class="filename">php-cgi.exe</var> への絶対パスで置き換えてください。
    <div class="example" id="install.unix.debian.apt.example">
     <p><strong>例9 IIS FastCGI プロセスプールの作成</strong></p>
     <div class="example-contents">
<div class="cdata"><pre>
%windir%\system32\inetsrv\appcmd set config /section:system.webServer/fastCGI ^
/+[fullPath=&#039;c:\PHP\php-cgi.exe&#039;]
</pre></div>
     </div>

    </div>
   </p>
   <p class="para">
    IIS に PHP のリクエストを処理させるには、以下のコマンドを実行します。
    <var class="varname"><var class="varname">scriptProcessor</var></var> パラメータの値は
    <var class="filename">php-cgi.exe</var> への絶対パスで置き換えてください。
    <div class="example" id="install.unix.debian.apt.example2">
     <p><strong>例10 PHP リクエスト用のハンドラマッピングの作成</strong></p>
     <div class="example-contents">
<div class="cdata"><pre>
%windir%\system32\inetsrv\appcmd set config /section:system.webServer/handlers ^
/+[name=&#039;PHP_via_FastCGI&#039;, path=&#039;*.php&#039;,verb=&#039;*&#039;,modules=&#039;FastCgiModule&#039;,^
scriptProcessor=&#039;c:\PHP\php-cgi.exe&#039;,resourceType=&#039;Either&#039;]
</pre></div>
     </div>

    </div>
   </p>
   <p class="para">
    このコマンドは、拡張子 *.php 用の IIS ハンドラマッピングを作成します。
    .php で終わるすべての URL を FastCGI モジュールで処理するようになります。
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <p class="para">
      この時点で、最低限必要なインストールと設定は完了しました。
      これ以降の手順は必須ではありませんが、IIS 上で PHP
      を効果的に動かすために強く推奨するものです。
     </p>
    </p></blockquote>
   </p>
  </div>
 </div>
 <div class="sect3" id="install.windows.legacy.iis7.impersonation">
  <h4 class="title">匿名化およびファイルシステムへのアクセス</h4>
  <p class="para">
   PHP を IIS で使う場合は、FastCGI の匿名化を有効にしておくことを推奨します。
   これは、<var class="filename">php.ini</var> ファイルの
   <var class="varname"><var class="varname">fastcgi.impersonate</var></var> ディレクティブで設定します。
   匿名化を有効にすると、PHP はすべてのファイルシステム操作を
   IIS 認証で定義したユーザーアカウントで行います。
   こうしておけば、同じ PHP プロセスを異なる IIS ウェブサイトで共有している場合でも
   (各サイトで IIS 認証のユーザーアカウントを分けておけば)
   一方の PHP スクリプトからもう一方のファイルはアクセスできなくなります。
  </p>
  <p class="para">
   IIS 7 のデフォルト設定では組み込みのユーザーアカウント
   IUSR による匿名認証が有効になっています。
   つまり、IIS で PHP スクリプトを実行する場合は IUSR
   アカウントにスクリプトの読み込み権限を付与しなければならないということです。
   PHP のアプリケーションからファイルへの書き込みやフォルダ内でのファイルの作成などをする場合は、
   IUSR アカウントに書き込み権限が必要となります。
  </p>
  <p class="para">
   IIS 7 の匿名認証で使うユーザーアカウントを設定するには、次のコマンドを実行します。
   &quot;Default Web Site&quot; の部分は、使用する IIS ウェブサイト名に置き換えてください。
   出力される XML 設定要素の中から <var class="varname"><var class="varname">userName</var></var> 属性を探します。
   <div class="example" id="install.unix.debian.config.example">
    <p><strong>例11 IIS 匿名認証で使うアカウントの設定</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
%windir%\system32\inetsrv\appcmd.exe list config &quot;Default Web Site&quot; ^
/section:anonymousAuthentication

&lt;system.webServer&gt;
  &lt;security&gt;
    &lt;authentication&gt;
      &lt;anonymousAuthentication enabled=&quot;true&quot; userName=&quot;IUSR&quot; /&gt;
    &lt;/authentication&gt;
   &lt;/security&gt;
&lt;/system.webServer&gt;
</pre></div>
    </div>

   </div>
   <blockquote class="note"><p><strong class="note">注意</strong>: 
    <p class="para">
     <var class="varname"><var class="varname">userName</var></var> 属性が <var class="varname"><var class="varname">anonymousAuthentication</var></var>
     要素になかったり、あるいは属性の値が空の文字列になっている場合は、
     アプリケーションプールの認証情報をそのウェブサイトの匿名認証で使います。
    </p>
   </p></blockquote>
  </p>
  <p class="para">
   ファイルやフォルダのパーミッションを変更するには、エクスプローラあるいは
   <var class="varname"><var class="varname">icacls</var></var> コマンドを使います。
   <div class="example" id="install.unix.debian.config.example2">
    <p><strong>例12 ファイルのアクセス権の設定</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
icacls C:\inetpub\wwwroot\upload /grant IUSR:(OI)(CI)(M)
</pre></div>
    </div>

   </div>
  </p>
 </div>
 <div class="sect3" id="install.windows.legacy.iis7.defaultdoc">
  <h4 class="title">IIS のデフォルトドキュメントを <var class="filename">index.php</var> にする</h4>
  <p class="para">
   ドキュメント名を指定しない HTTP リクエストを受け取ったときには、
   IIS のデフォルトドキュメントが使われます。PHP アプリケーションでは、通常は
   <var class="filename">index.php</var> をデフォルトドキュメントとします。
   <var class="filename">index.php</var> を IIS のデフォルトドキュメントに追加するには、
   次のようにします。
   <div class="example" id="example-20">
    <p><strong>例13 <var class="filename">index.php</var> を IIS のデフォルトドキュメントにする</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
%windir%\system32\inetsrv\appcmd.exe set config ^
-section:system.webServer/defaultDocument /+&quot;files.[value=&#039;index.php&#039;]&quot; ^
/commit:apphost
</pre></div>
    </div>

   </div>   
  </p>
 </div>
 <div class="sect3" id="install.windows.legacy.iis7.recycling">
  <h4 class="title">FastCGI および PHP の再利用設定</h4>
  <p class="para">
   IIS FastCGI で PHP プロセスの再利用を設定するには以下のコマンドを使います。
   FastCGI の設定項目 <var class="varname"><var class="varname">instanceMaxRequests</var></var> は、
   ひとつの <var class="filename">php-cgi.exe</var> が何回リクエストを処理すると
   FastCGI エクステンションがシャットダウンさせるかを表します。
   PHP の環境変数 <var class="varname"><var class="varname">PHP_FCGI_MAX_REQUESTS</var></var> は、
   ひとつの <var class="filename">php-cgi.exe</var> プロセスが何回リクエストを処理すると
   自分をリサイクルするかを表します。
   FastCGI の <var class="varname"><var class="varname">InstanceMaxRequests</var></var>
   で設定した値が <var class="varname"><var class="varname">PHP_FCGI_MAX_REQUESTS</var></var>
   以下になるようにしましょう。
   <div class="example" id="example-21">
    <p><strong>例14 FastCGI と PHP の再利用設定</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
%windir%\system32\inetsrv\appcmd.exe set config -section:system.webServer/fastCgi ^
/[fullPath=&#039;c:\php\php-cgi.exe&#039;].instanceMaxRequests:10000

%windir%\system32\inetsrv\appcmd.exe set config -section:system.webServer/fastCgi ^
/+&quot;[fullPath=&#039;C:\{php_folder}\php-cgi.exe&#039;].environmentVariables.^
[name=&#039;PHP_FCGI_MAX_REQUESTS&#039;,value=&#039;10000&#039;]&quot;
</pre></div>
    </div>

   </div>
  </p>
 </div>
 <div class="sect3" id="install.windows.legacy.iis7.timeouts">
  <h4 class="title">FastCGI のタイムアウト設定</h4>
  <p class="para">
   実行時間が長くなる PHP スクリプトがある場合は、FastCGI
   のタイムアウト設定を増やします。タイムアウトに関連する設定項目は
   <var class="varname"><var class="varname">activityTimeout</var></var> と <var class="varname"><var class="varname">requestTimeout</var></var> です。
   タイムアウト設定を変更するには以下のコマンドを使います。
   <var class="varname"><var class="varname">fullPath</var></var> パラメータの値を
   <var class="filename">php-cgi.exe</var> ファイルへの絶対パスに置き換えてください。
   <div class="example" id="example-22">
    <p><strong>例15 FastCGI のタイムアウト設定</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
%windir%\system32\inetsrv\appcmd.exe set config -section:system.webServer/fastCgi ^
/[fullPath=&#039;C:\php\php-cgi.exe&#039;,arguments=&#039;&#039;].activityTimeout:&quot;90&quot;  /commit:apphost

%windir%\system32\inetsrv\appcmd.exe set config -section:system.webServer/fastCgi ^
/[fullPath=&#039;C:\php\php-cgi.exe&#039;,arguments=&#039;&#039;].requestTimeout:&quot;90&quot;  /commit:apphost
</pre></div>
    </div>

   </div>   
  </p>
 </div>
 <div class="sect3" id="install.windows.legacy.iis7.phpinilocation">
  <h4 class="title"><var class="filename">php.ini</var> ファイルの場所の変更</h4>
  <p class="para">
   PHP が <var class="filename">php.ini</var> ファイルを探す場所は
   <a href="configuration.file.html" class="link">いくつかあり</a>、
   <var class="filename">php.ini</var> ファイルのデフォルトの場所を
   環境変数 <var class="varname"><var class="varname">PHPRC</var></var> で変更することができます。
   特定の場所においた設定ファイルを PHP に読み込ませたい場合は、
   以下のコマンドを実行します。環境変数 <var class="varname"><var class="varname">PHPRC</var></var>
   には、<var class="filename">php.ini</var>
   ファイルがあるディレクトリへの絶対パスを指定しなければなりません。
   <div class="example" id="example-23">
    <p><strong>例16 <var class="filename">php.ini</var> ファイルの場所の変更</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
appcmd.exe set config  -section:system.webServer/fastCgi ^
/+&quot;[fullPath=&#039;C:\php\php.exe&#039;,arguments=&#039;&#039;].environmentVariables.^
[name=&#039;PHPRC&#039;,value=&#039;C:\Some\Directory\&#039;]&quot; /commit:apphost
</pre></div>         
    </div>

   </div>   
  </p>
 </div>
</div>


   
   



   <div class="sect2" id="install.windows.legacy.apache1">
    <h3 class="title">Apache 1.3.x （Microsoft Windows 用）</h3>
    <p class="para">
     このセクションでは、Microsoft Windows 上の Apache 1.3.x で PHP
     を使用する場合について説明します。
     
    </p>
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <p class="para">
      まず始めに、<a href="install.windows.legacy.index.html#install.windows.legacy.manual" class="link">マニュアルインストールの手順</a> 
      をお読みください。
     </p>
    </p></blockquote>
    
    <p class="simpara">
     PHP を Windows 上の Apache 1.3.x で動作させるには、2種類の方法が
     あります。一つは、CGI バイナリ (PHP 4 の場合 <var class="filename">php.exe</var>、
     PHP 5 の場合 <var class="filename">php-cgi.exe</var>) を使用する方法、もう一つ
     は Apache モジュール DLL を使用する方法です。どちらの場合も 
     <var class="filename">httpd.conf</var> を編集して Apache が PHP を利用できるようにした後、
     Apache サーバーを再起動する必要があります。
    </p>
    
    <p class="simpara">
     Windwos 環境向けの SAPI モジュールはかなり安定してきているため、
     透過性と安全性の面からも CGI バイナリより SAPI モジュールの
     使用を推奨します。
    </p>
    
    <p class="simpara">
     Apache で PHP を使うように設定する手順にはいくつかのバリエーションがありますが、
     いずれも入門者にもできるほど簡単です。設定ディレクティブに関する詳細については、
     Apache のドキュメントも参照してください。
    </p>
  
    <p class="simpara">
     設定ファイルを変更した後、サーバーの再起動を忘れずに行ってください。
     Apache を Windows サービスとして実行しているなら、<strong class="command">NET STOP APACHE</strong>
     とした後 <strong class="command">NET START APACHE</strong> とします。
     もしくは、スタートメニューのショートカットからも再起動できる場合もあります。
    </p>
    
    <blockquote class="note"><p><strong class="note">注意</strong>: <span class="simpara">Windows 上で
Apache 設定ファイルにパスの値を追加する際、例えば
<var class="filename">c:\directory\file.ext</var> に含まれるすべてのバックスラッシュは
<var class="filename">c:/directory/file.ext</var> のように前向きスラッシュに変換する必要があります。
また、ディレクトリを表す際には最後にスラッシュをつけなければなりません。
</span></p></blockquote>

    <div class="sect3" id="install.windows.legacy.apache1.module">
     <h4 class="title">Apache モジュールの使用</h4>
     <p class="para">
      以下の行を Apache の <var class="filename">httpd.conf</var> ファイルに追加してください。
     </p>
     <p class="para">
      <div class="example" id="example-24">
       <p><strong>例17 Apache 1.3.x でモジュール版の PHP を使用する場合の設定</strong></p>
        <div class="example-contents"><p>
         以下では、PHP は <var class="filename">c:\php</var> にインストールされていると仮定します。
         そうでない場合はパスを適当に修正してください。
        </p></div>
        <div class="example-contents"><p>
         PHP 4 の場合
        </p></div>
        <div class="example-contents">
<div class="apache-confcode"><pre class="apache-confcode"># LoadModule セクションの最後に追加
# sapi ディレクトリからこのファイルをコピーするのを忘れないこと!
LoadModule php4_module &quot;C:/php/php4apache.dll&quot;

# AddModule セクションの最後に追加
AddModule mod_php4.c</pre>
</div>
       </div>

       <div class="example-contents"><p>
        PHP 5 の場合
       </p></div>
       <div class="example-contents">
<div class="apache-confcode"><pre class="apache-confcode"># LoadModule セクションの最後に追加
LoadModule php5_module &quot;C:/php/php5apache.dll&quot;

# AddModule セクションの最後に追加
AddModule mod_php5.c</pre>
</div>
       </div>

       <div class="example-contents"><p>
        共通
       </p></div>
       <div class="example-contents">
<div class="apache-confcode"><pre class="apache-confcode"># &lt;IfModule mod_mime.c&gt; 条件節の内部に追加
AddType application/x-httpd-php .php

# .phps ファイルを構文ハイライト表示する場合に追加
AddType application/x-httpd-php-source .phps</pre>
</div>
       </div>

      </div>
     </p>
    </div>

    <div class="sect3" id="install.windows.legacy.apache1.cgi">
     <h4 class="title">CGI バイナリの使用</h4>
    
     <p class="para">
      <a href="install.windows.legacy.index.html#install.windows.legacy.manual" class="link">マニュアルインストールの手順</a>
      のセクションにある通り、PHP パッケージを <var class="filename">C:\php\</var>
      に展開したならば、以下を Apache の設定ファイルに追加すれば
      CGI バイナリを利用可能にできます。
      <div class="example" id="example-25">
       <p><strong>例18 Apache 1.3.x で CGI 版の PHP を使用する場合の設定</strong></p>
        <div class="example-contents">
<div class="apache-confcode"><pre class="apache-confcode">ScriptAlias /php/ &quot;c:/php/&quot;
AddType application/x-httpd-php .php

# PHP 4 の場合
Action application/x-httpd-php &quot;/php/php.exe&quot;

# PHP 5 の場合
Action application/x-httpd-php &quot;/php/php-cgi.exe&quot;

# php.ini の場所を設定
SetEnv PHPRC C:/php</pre>
</div>
       </div>

      </div>
      上記の 2 行目は、コメントアウトされた状態で <var class="filename">httpd.conf</var>
      に記載されている場合があります。また、<var class="filename">c:/php/</var>
      は、実際のパスにあわせて修正してください。
     </p>
     <div class="warning"><strong class="warning">警告</strong><p class="para">
CGI モードで公開したサーバーは、いくつかの脆弱性の標的となる可能性があります。
これらの攻撃からサーバーを守る方法については、
<a href="security.cgi-bin.html" class="link">CGI セキュリティ</a>
のセクションを参照してください。</p></div>
     <p class="simpara">
      PHP ソースの構文ハイライト表示については、モジュール版にあるような便利な
      オプションはありません。Apache で CGI 版の PHP を使用している場合、
      <span class="function"><a href="function.highlight-file.html" class="function">highlight_file()</a></span> 関数を使用してください。
      普通に PHP スクリプトを作成し、次のようにコードを記述すれば、構文ハイライト表示が可能です。
      <em>&lt;?php highlight_file(&#039;ハイライト表示するファイル&#039;); ?&gt;</em>
     </p>
    </div>

   </div>



   



   <div class="sect2" id="install.windows.legacy.apache2">
    <h3 class="title">Apache 2.x （Microsoft Windows 用）</h3>
    <p class="para">
     このセクションでは、Microsoft Windows 上の Apache 2.x で PHP
     を使用する場合について説明します。
     
    </p>
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <p class="para">
      まず始めに、<a href="install.windows.legacy.index.html#install.windows.legacy.manual" class="link">マニュアルインストールの手順</a> 
      をお読みください。
     </p>
    </p></blockquote>
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <strong>Apache 2.2 のサポート</strong><br />
     <p class="para">
      Apache 2.2 を利用している方は、Apache 2.2 用の DLL ファイルの名前が
      <var class="filename">php5apache2.dll</var> ではなく
      <var class="filename">php5apache2_2.dll</var> であることに注意しましょう。
      このファイルは PHP 5.2.0 以降にしか含まれません。
     </p>
    </p></blockquote>
    
    <p class="para">
     <a href="http://httpd.apache.org/docs/current/" class="link external">&raquo;&nbsp;Apache ドキュメンテーション</a>
     を参照し、Apache 2.x サーバーの基本を理解しておくことを強く推奨します。
     また、以下の解説を読む前に、Apache 2.x に関する
     <a href="http://httpd.apache.org/docs/current/platform/windows.html" class="link external">&raquo;&nbsp;Windows 固有の情報</a>
     についても参照するとよいでしょう。
    </p>
    
     <p class="para">
      Apache 2.x は、サーバープラットフォーム用の Windows、
      つまり Windows NT 4.0, Windows 2000, Windows XP および
      Windows 7 で動作するように設計されています。Apache 2.x
      は Windows 9x でもそれなりに動作しますが、サポートは不完全です。
      また、一部うまく動作しない機能もあります。
      この問題の解決策はありません。
     </p>

    <p class="para">
     最新の <a href="http://httpd.apache.org/" class="link external">&raquo;&nbsp;Apache 2.x</a> と、
     対応するバージョンの PHP をダウンロードしてください。
     <a href="install.windows.legacy.index.html#install.windows.legacy.manual" class="link">マニュアルインストールの手順</a>
     を実施したら、引き続き以下のとおり PHP と Apache の設定を行ってください。
    </p>

    <p class="para">
     PHP を Windows 上の Apache 2.x で動かすには三通りの方法があります。
     PHP をハンドラとして動かす方法、CGI として動かす方法、そして
     FastCGI で動かす方法です。
    </p>
    
    <blockquote class="note"><p><strong class="note">注意</strong>: <span class="simpara">Windows 上で
Apache 設定ファイルにパスの値を追加する際、例えば
<var class="filename">c:\directory\file.ext</var> に含まれるすべてのバックスラッシュは
<var class="filename">c:/directory/file.ext</var> のように前向きスラッシュに変換する必要があります。
また、ディレクトリを表す際には最後にスラッシュをつけなければなりません。
</span></p></blockquote>
    
    <div class="sect3" id="install.windows.apache2.legacy.module">
     <h4 class="title">Apache ハンドラとしてのインストール</h4>
     <p class="para">
      以下の行を Apache 設定ファイル <var class="filename">httpd.conf</var> に追加して
      Apache 2.x 用の PHP モジュールを読み込まなければなりません。
      <div class="example" id="example-26">
       <p><strong>例19 PHP を Apache 2.x ハンドラとして使う設定</strong></p>
        <div class="example-contents">
<div class="apache-confcode"><pre class="apache-confcode"># 
LoadModule php5_module &quot;c:/php/php5apache2.dll&quot;
AddHandler application/x-httpd-php .php

# php.ini へのパスを設定します
PHPIniDir &quot;C:/php&quot;</pre>
</div>
       </div>

      </div>
     </p>
     <blockquote class="note"><p><strong class="note">注意</strong>: 
      <span class="simpara">
       上の例の <var class="filename">C:/php/</var> は実際のパスにあわせて修正してください。
       LoadModule ディレクティブで <var class="filename">php5apache2.dll</var> と
       <var class="filename">php5apache2_2.dll</var> のどちらを使うのかに注意し、
       指定したファイルが実際にその場所にあるかどうかを忘れずに確認しましょう。
      </span>
     </p></blockquote>
      <p class="para">
      上の設定は、拡張子 .php を含むすべてのファイルを PHP で処理するようにします。
      たとえそれ以外の拡張子が含まれていたとしてもです。たとえば
      <var class="filename">example.php.txt</var> という名前のファイルも
      PHP ハンドラが処理します。ファイル名の <em class="emphasis">最後が</em>
      <var class="filename">.php</var> であるものだけを処理させたい場合は、次のように設定します。
      </p>

      <div class="example" id="example-27">
        <div class="example-contents">
<div class="apache-confcode"><pre class="apache-confcode">&lt;FilesMatch \.php$&gt;
      SetHandler application/x-httpd-php
 &lt;/FilesMatch&gt;</pre>
</div>
       </div>

      </div>
    </div>

    <div class="sect3" id="install.windows.apache2.legacy.cgi">
     <h4 class="title">CGI としての PHP の実行</h4>

     <p class="para">
      <a href="http://httpd.apache.org/docs/current/howto/cgi.html" class="link external">&raquo;&nbsp;Apache CGI
      ドキュメント</a> を読み、Apache 上の CGI について理解しておきましょう。
     </p>
   
     <p class="para">
      PHP を CGI として実行するには、ScriptAlias
      ディレクティブで CGI ディレクトリとして指定した場所に
      php-cgi ファイルを置かなければなりません。
     </p>

     <p class="para">
      さらに、PHP ファイルに #! の行を追加して PHP バイナリの場所を指定しなければなりません。

      <div class="example" id="example-28">
       <p><strong>例20 PHP を Apache 2.x 上で CGI として動かす例</strong></p>
        <div class="example-contents">
<div class="cdata"><pre>
#!C:/php/php.exe
&lt;?php
  phpinfo();
?&gt;
</pre></div>
       </div>

      </div>
     </p>
     <div class="warning"><strong class="warning">警告</strong><p class="para">
CGI モードで公開したサーバーは、いくつかの脆弱性の標的となる可能性があります。
これらの攻撃からサーバーを守る方法については、
<a href="security.cgi-bin.html" class="link">CGI セキュリティ</a>
のセクションを参照してください。</p></div>
    </div>

    <div class="sect3" id="install.windows.apache2.legacy.fastcgi">
     <h4 class="title">PHP を FastCGI で実行する</h4>

     <p class="para">
     PHP を FastCGI で動かすのには、CGI として動かすのにくらべると多くの利点があります。
     設定方法は単純明快です。
     </p>
     <p class="para">
     まず mod_fcgid を
     <a href="http://httpd.apache.org/mod_fcgid/" class="link external">&raquo;&nbsp;http://httpd.apache.org/mod_fcgid/</a>
     から取得します。Win32 用のバイナリがこのサイトからダウンロードできます。
     そして、説明に従ってモジュールをインストールしましょう。
     </p>
     <p class="para">
     次にウェブサーバーを以下のように設定します。
     パスの部分は適切に変更し、インストールするシステム上の環境にあわせましょう。

     <div class="example" id="example-29">
     <p><strong>例21 PHP を FastCGI として動かす Apache の設定</strong></p>
     <div class="example-contents">
<div class="cdata"><pre>
LoadModule fcgid_module modules/mod_fcgid.so  

# Where is your php.ini file?
FcgidInitialEnv PHPRC        &quot;c:/php&quot; 

AddHandler fcgid-script .php  
FcgidWrapper &quot;c:/php/php-cgi.exe&quot; .php  
</pre></div>
     </div>

     </div>

     これで、拡張子 .php のファイルは PHP FastCGI
     ラッパーが処理するようになります。
     </p>

    </div>

   </div>



   



  <div class="sect2" id="install.windows.legacy.sun">
   <h3 class="title">Sun, iPlanet, Netscape サーバー（Microsoft Windows 用）</h3>
   <p class="para">
    このセクションでは、Windows 上の Sun Java System Web Server,
    Sun ONE Web Server, iPlanet and Netscape server で PHP 
    を使用する場合について説明します。
   </p>
   <p class="para">
    PHP 4.3.3 より、<a href="ref.nsapi.html" class="link">NSAPI モジュール</a> を使うことが可能です。
    
   </p>
   
   <div class="sect3" id="install.windows.legacy.sun.cgi">
    <h4 class="title">Sun, iPlanet, Netscape サーバー で CGI 版の PHP を使用する</h4> 
    <p class="para">
     CGI 版の PHP を使用する場合は、以下のようにしてください。
    </p>
    <ul class="itemizedlist">
     <li class="listitem">
      <span class="simpara">
       <var class="filename">php4ts.dll</var> をシステムルート
       （Windows がインストールされているフォルダ）にコピーします。
      </span>
     </li>
     <li class="listitem">
      <p class="para">
       コマンドラインからファイルの関連付けを行います。
       次の 2 行をタイプしてください。
       <div class="example-contents">
<div class="shellcode"><pre class="shellcode">assoc .php=PHPScript
ftype PHPScript=c:\php\php.exe %1 %*</pre>
</div>
       </div>

      </p>
     </li>
     <li class="listitem">
      <span class="simpara">
       Netscape Enterprise Administration Server で、ダミーの shellcgi 
       ディレクトリを作成し、その後すぐに削除します
       （このステップにより 5 つの重要な行が obj.conf に作成され、
       Web サーバーが shellcgi スクリプトを扱えるようになります。）
      </span>
     </li>
     <li class="listitem">
      <span class="simpara">
       Netscape Enterprise Administration Server で
       新しい mime type を作成します。(Category: type, 
       Content-Type: magnus-internal/shellcgi, File Suffix:php)
      </span>
     </li>
     <li class="listitem">
      <span class="simpara">
       PHP を実行するすべての Web サーバーインスタンスで上記を実行してください。
      </span>
     </li>
    </ul>
    <p class="para">
     CGI 版の PHP を使用する場合の詳細な説明は
     <a href="http://benoit.noss.free.fr/php/install-php.html" class="link external">&raquo;&nbsp;http://benoit.noss.free.fr/php/install-php.html</a>
     を参照してください。
    </p>
   </div>
    
   <div class="sect3" id="install.windows.legacy.sun.nsapi">
    <h4 class="title">Sun, iPlanet, Netscape サーバー で NSAPI 版の PHP を使用する</h4> 
    <p class="para">
     NSAPI 版の PHP を使用する場合は、以下のようにしてください。
    </p>
    <ul class="itemizedlist">
     <li class="listitem">
      <span class="simpara">
       <var class="filename">php4ts.dll</var> をシステムルート
       （Windows がインストールされているディレクトリ）にコピーする。
      </span>
     </li>
     <li class="listitem">
      <p class="para">
       コマンドラインからファイルの関連付けを行います。
       次の 2 行をタイプしてください。
       <div class="example-contents">
<div class="shellcode"><pre class="shellcode">assoc .php=PHPScript
ftype PHPScript=c:\php\php.exe %1 %*</pre>
</div>
       </div>

      </p>
     </li>
     <li class="listitem">
      <span class="simpara">
       Netscape Enterprise Administration Server において
       新しい mime type を作成します。 (Category: type, 
       Content-Type: magnus-internal/shellcgi, File Suffix:php)  
      </span>
     </li>
     <li class="listitem">
      <p class="para">
        <var class="filename">magnus.conf</var> (サーバー&gt;= 6の場合) または
        <var class="filename">obj.conf</var> (サーバー&lt; 6の場合)を編集し、
        以下の行を追加します。
        この行は <em>mime types init</em> の後に記述する必要があります。
       <div class="example-contents">
<div class="cdata"><pre>
Init fn=&quot;load-modules&quot; funcs=&quot;php4_init,php4_execute,php4_auth_trans&quot; shlib=&quot;c:/php/sapi/php4nsapi.dll&quot;
Init fn=&quot;php4_init&quot; LateInit=&quot;yes&quot; errorString=&quot;Failed to initialise PHP!&quot; [php_ini=&quot;c:/path/to/php.ini&quot;]
</pre></div>
       </div>

       (PHP &gt;= 4.3.3) 
       <em>php_ini</em> パラメータはオプションですが、
       これを指定することにより、Web サーバーの設定ファイルがあるフォルダに
       <var class="filename">php.ini</var> を置くことが可能になります。
      </p>
     </li>
     <li class="listitem">
      <p class="para">
       <var class="filename">obj.conf</var> のデフォルトオブジェクトを設定します
       （仮想サーバーの場合、<var class="filename">vserver.obj.conf</var>
       のクラス [SunONE 6.0]。）
       <em>&lt; Object name=&quot;default&quot; &gt;</em> セクションに
       次の行を追加してください。この行は、
       &#039;ObjectType&#039; の後、&#039;AddLog&#039; の前に記述してください。
       <div class="example-contents">
<div class="cdata"><pre>
Service fn=&quot;php4_execute&quot; type=&quot;magnus-internal/x-httpd-php&quot; [inikey=value inikey=value ...]
</pre></div>
       </div>

       (PHP &gt;= 4.3.3) 
       追加のパラメータとして、いくつかの特別な <var class="filename">php.ini</var> 値を
       追加することができます。例えば、コンテキスト
       <em>php4_execute</em> をコールする時に
       <em>docroot=&quot;/path/to/docroot&quot;</em> 
       を設定することができます。
       論理値の場合、
       <em>&quot;On&quot;,&quot;Off&quot;,...</em>（これは正
       しく動作しません）ではなく、0/1 を値として使用してください。
       例えば、
       <em>zlib.output_compression=&quot;On&quot;</em> ではなく、
       <em>zlib.output_compression=1</em> とします。
      </p>
     </li>
     <li class="listitem">
      <p class="para">
       以下は、（<var class="filename">cgi-bin</var> ディレクトリ
       のように）PHP スクリプトのみからなるディレクトリを設定したい場合にだけ必要です。
       <div class="example-contents">
<div class="cdata"><pre>
&lt;Object name=&quot;x-httpd-php&quot;&gt;
ObjectType fn=&quot;force-type&quot; type=&quot;magnus-internal/x-httpd-php&quot;
Service fn=php4_execute [inikey=value inikey=value ...]
&lt;/Object&gt;
</pre></div>
       </div>

       これにより、Administration Server に特定のディレクトリを設定し、
       これをスタイル <em>x-httpd-php</em> に割り付けることができ
       ます。このディレクトリの中にあるすべてのファイルは PHP スクリプト
       として実行されます。
       これは、ファイルの名前を <var class="filename">.html</var> に変更し、PHP
       が使用されている事を隠したい場合に有用です。
      </p>
     </li>
     <li class="listitem">
      <span class="simpara">
       Web サービスを再起動して設定を反映させます。
      </span>
     </li>
     <li class="listitem">
      <span class="simpara">
       PHP を実行するすべての Web サーバーインスタンスで上記を行ってください。
      </span>
     </li>
    </ul>
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <p class="para">
      NSAPI 版の PHP の使用についてのより詳細な説明は
      <a href="http://benoit.noss.free.fr/php/install-php4.html" class="link external">&raquo;&nbsp;http://benoit.noss.free.fr/php/install-php4.html</a>
      をご覧ください。
     </p>
    </p></blockquote>
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <p class="para">
      PHP が使用するスタックサイズは WEB サーバーの設定に依存します。
      非常に大きい PHP スクリプトを実行させた際にクラッシュする場合は、
      Administration Server でスタックサイズ（&quot;MAGNUS EDITOR&quot;）
      を大きくすると良いでしょう。
     </p>
    </p></blockquote>
   </div>
   
   <div class="sect3" id="install.windows.legacy.sun.phpini">
    <h4 class="title">CGI 環境変数と <var class="filename">php.ini</var> の変更</h4>
    <p class="para">
     Sun JSWS/Sun ONE WS/iPlanet/Netscape がマルチスレッドの WEB サーバーだという事が
     PHP スクリプトを書く際に重要になります。すべてのリクエストは同一の
     （WEB サーバー自体の）プロセス空間で実行されます。<em>PATH_INFO</em>
     や <em>HTTP_HOST</em> などの CGI 変数を取得する場合、
     古い PHP で行っていたような方法、つまり <span class="function"><a href="function.getenv.html" class="function">getenv()</a></span>  
     関数を使用する方法や他の同等な方法（グローバル変数の登録機能、 <em>$_ENV</em>
     等）を使うのは正しい方法ではありません。WEB サーバーの環境変数をただ単に取得すると、
     正しい CGI 変数は得られません。
    </p>
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <p class="para">
      なぜ正しくない CGI 変数が登録されているのでしょうか？
     </p>
     <p class="para">
      それは、WEB サーバーのプロセスを Administration Server から起動させる際、
      WEB サーバーの起動スクリプトが CGI スクリプトとして実行されるためです。したがって、
      起動された WEB サーバーの環境変数には CGI 変数も含まれることになります。
      Administration Server 以外から WEB サーバーを起動してみればこのことをテストできるでしょう。
      ルートユーザーでコマンドラインを使って、手動で起動してみると、CGI 変数らしき
      環境変数が登録されないことが確認できると思います。
     </p>
    </p></blockquote>
    <p class="para">
     PHP 4.x のスクリプトで CGI 変数を取得する場合は、スーパーグローバル
     <var class="varname"><var class="varname"><a href="reserved.variables.server.html" class="classname">$_SERVER</a></var></var> を用いるのが正しい方法です。また、<var class="varname"><var class="varname">$HTTP_HOST</var></var>
     などを使う古いスクリプトを使用する場合は、<var class="filename">php.ini</var> で <em>register_globals</em> 
     をオンにし、変数のパースの順番 (<em>variables_order</em>) を変更してください
     （<em>&quot;E&quot;</em> を削除。環境変数を読み込む必要は無いため。）
     <div class="example-contents">
<div class="cdata"><pre>
variables_order = &quot;GPCS&quot;
register_globals = On
</pre></div>
     </div>

    </p>
   </div>
   
   <div class="sect3" id="install.windows.legacy.sun.specialpages">
    <h4 class="title">独自エラーページおよびファイル一覧表示ページ (PHP &gt;= 4.3.3)</h4>
    <p class="para">
     PHP を使って、<em>&quot;404 Not Found&quot;</em> などに対するエラーページを生成することが
     できます。オーバーライドしたいエラーページすべてに対して、以下の行を
     <var class="filename">obj.conf</var> 中のオブジェクトに追加してください。
     <div class="example-contents">
<div class="cdata"><pre>
Error fn=&quot;php4_execute&quot; code=XXX script=&quot;/path/to/script.php&quot; [inikey=value inikey=value...]
</pre></div>
     </div>

     ここで、<em>XXX</em> は HTTP のエラーコードです。
     追加したものと干渉する <em>Error</em> ディレクティブは削除してください。
     発生するすべてのエラーに対応するページを設定したい場合は、
     <em>code</em> パラメータを省略してください。スクリプトで HTTP ステータス
     コードを取得するには、<var class="varname"><var class="varname"><a href="reserved.variables.server.html" class="classname">$_SERVER['ERROR_TYPE']</a></var></var> を使用します。
    </p>
    <p class="para">
     独自のファイル一覧表示ページを PHP を使って生成することも可能です。
     ファイル一覧表示を行う PHP スクリプトを作成し、<var class="filename">obj.conf</var> の
     <em>type=&quot;magnus-internal/directory&quot;</em> の行に
     書かれているデフォルトのサービスを以下のように置き換えます。
     <div class="example-contents">
<div class="cdata"><pre>
Service fn=&quot;php4_execute&quot; type=&quot;magnus-internal/directory&quot; script=&quot;/path/to/script.php&quot; [inikey=value inikey=value...]
</pre></div>
     </div>

     エラーページ、ファイル一覧表示ページのどちらでも、元の URI および
     変換後の URI は、それぞれ、<var class="varname"><var class="varname"><a href="reserved.variables.server.html" class="classname">$_SERVER['PATH_INFO']</a></var></var> および
     <var class="varname"><var class="varname"><a href="reserved.variables.server.html" class="classname">$_SERVER['PATH_TRANSLATED']</a></var></var> に格納されています。
    </p>
   </div>
   
   <div class="sect3" id="install.windows.legacy.sun.notes">
    <h4 class="title"><span class="function"><a href="function.nsapi-virtual.html" class="function">nsapi_virtual()</a></span> およびサブリクエストに関する注意 (PHP &gt;= 4.3.3)</h4>
    <p class="para">
     NSAPI モジュールは、現在、<span class="function"><a href="function.nsapi-virtual.html" class="function">nsapi_virtual()</a></span> 関数
     (エイリアス: <span class="function"><a href="function.virtual.html" class="function">virtual()</a></span>) をサポートしており、
     WEB サーバーへサブリクエストを行い、結果を WEB ページへ挿入することができます。
     問題としては、この関数は 文書化されていない NSAPI ライブラリの機能を使用して
     いることにあります。
    </p>
    <p class="para">
     Unix では、モジュールは自動的に必要な関数群を探し、可能であればそれらの関数を
     使用するため、特に問題はありません。もし使用可能でなければ、<span class="function"><a href="function.nsapi-virtual.html" class="function">nsapi_virtual()</a></span> は
     使用不可となります。
    </p>
    <p class="para">
     Windows では、DLL の扱いに制限があるため、自動認識の使用には
     最新の <var class="filename">ns-httpdXX.dll</var> ファイルが必要です。
     バージョン 6.1 までテストが行われています。もし、より新しい Sun サーバーを使う場合は、
     自動認識が動作せず、<span class="function"><a href="function.nsapi-virtual.html" class="function">nsapi_virtual()</a></span> が使用不可となる可能性が
     あります。
    </p>
    <p class="para">
     もしそういった事になった場合は、
     <var class="filename">magnus.conf</var>/<var class="filename">obj.conf</var>
     の <em>php4_init</em> へ以下のパラメータを追加してください。
     <div class="example-contents">
<div class="cdata"><pre>
Init fn=php4_init ... server_lib=&quot;ns-httpdXX.dll&quot;
</pre></div>
     </div>

     ここで、<em>XX</em> は接続する DLL のバージョン番号です。
     番号を調べるには、サーバーのルートで、対応する名前のファイルを探してください。
     おそらく、最もファイルサイズの大きい DLL が探しているファイルでしょう。
    </p>
    <p class="para">
     ステータスは <span class="function"><a href="function.phpinfo.html" class="function">phpinfo()</a></span> 関数を使って確認できます。
    </p>
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <p class="para">
      <span class="function"><a href="function.nsapi-virtual.html" class="function">nsapi_virtual()</a></span> サポートは「実験的」な機能です。
     </p>
    </p></blockquote>
   </div>   
  </div>



   



   <div class="sect2" id="install.windows.legacy.sambar">
    <h3 class="title">Sambar サーバー（Microsoft Windows 用）</h3>
    <p class="para">
     このセクションでは、Windows 上の <a href="http://www.sambar.com/" class="link external">&raquo;&nbsp;Sambar Server</a>
     で PHP を使用する場合について説明します。
    </p>
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <p class="para">
      まず始めに、<a href="install.windows.legacy.index.html#install.windows.legacy.manual" class="link">マニュアルインストールの手順</a> 
      をお読みください。
     </p>
    </p></blockquote>
    <p class="simpara">
     以下の手順は、Windows上 の Sambar サーバーで ISAPI モジュール版の PHP を使うように
     設定する方法を解説するものです。
    </p>

    <p class="para">
     <ul class="itemizedlist">
      <li class="listitem">
       <p class="para">
        Sambar をインストールしたフォルダ (の config フォルダ)にある
        <var class="filename">mappings.ini</var> という名前のファイルを探します。
       </p>
      </li>
      <li class="listitem">
       <p class="para">
        <var class="filename">mappings.ini</var> を開き、以下の行を
        <em>[ISAPI]</em> の下に追加します。
      <div class="example" id="example-30">
       <p><strong>例22 Sambar での ISAPI の設定</strong></p>
       <div class="example-contents">
<div class="cdata"><pre>
# PHP 4 用
*.php = c:\php\php4isapi.dll

# PHP 5 用
*.php = c:\php\php5isapi.dll
</pre></div>
       </div>

      </div>
        (PHP が <em>c:\php</em> にインストールされていると
        仮定しています。)
       </p>
      </li>
      <li class="listitem">
       <p class="para">
        変更を有効にするために Sambar サーバーを再起動します。
       </p>
      </li>
     </ul>
    </p>

    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <p class="para">
      PHP で
      ネットワーク上の他のコンピュータにあるリソースと通信したい場合は、
      Sambar Server サービスが使用するアカウントを変更する必要があります。
      Sambar Server サービスが使用しているデフォルトのアカウントは
      LocalSystem で、これはリモートのリソースにアクセスできません。
      アカウントを変更するには、コントロールパネルの管理ツールから
      「サービス」を使用します。
     </p>
    </p></blockquote>
   </div>



   



   <div class="sect2" id="install.windows.legacy.xitami">
    <h3 class="title">Xitami（Microsoft Windows 用）</h3>
    <p class="para">
     このセクションでは、Windows 上の <a href="http://www.xitami.com/" class="link external">&raquo;&nbsp;Xitami</a> 
     で PHP を使用する場合について説明します。
    </p>
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <p class="para">
      まず始めに、<a href="install.windows.legacy.index.html#install.windows.legacy.manual" class="link">マニュアルインストールの手順</a> 
      をお読みください。
     </p>
    </p></blockquote>
    <p class="simpara">
     以下の手順は、Windows 上の Xitami でPHP の CGI 版バイナリを動作させる際の
     設定方法です。
    </p>
    
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <strong>CGI 版 PHP を使用する場合</strong><br />
     <p class="para">
      <a href="faq.installation.html#faq.installation.forceredirect" class="link">cgi.force_redirectに関するFAQ</a> 
      に重要な情報がありますのでお読みください。このディレクティブが <em>0</em>
      にセットされている必要があります。
      <em>$_SERVER[&#039;PHP_SELF&#039;]</em> を使用する場合は、
      <a href="ini.core.html#ini.cgi.fix-pathinfo" class="link">cgi.fix_pathinfo</a> 
      をオンにする必要があります。
     </p>
    </p></blockquote>
    <div class="warning"><strong class="warning">警告</strong><p class="para">
CGI モードで公開したサーバーは、いくつかの脆弱性の標的となる可能性があります。
これらの攻撃からサーバーを守る方法については、
<a href="security.cgi-bin.html" class="link">CGI セキュリティ</a>
のセクションを参照してください。</p></div>
    <p class="para">
     <ul class="itemizedlist">
      <li class="listitem">
       <p class="para">
        Web サーバーが正常に動作していることを確認し、
        ブラウザで Xitami 管理用コンソール（通常は
        <em>http://127.0.0.1/admin</em>）を参照して、「Configuration」を
        クリックします。
       </p>
      </li>
      <li class="listitem">
       <p class="para">
        「Filters」を選択し、php にパースさせるファイルの拡張子 (.php など) を
        「File extensions (.xxx) 」フィールドに入力します。
       </p>
      </li>
      <li class="listitem">
       <p class="para">
        「Filter command or script」に、CGI 版 PHP バイナリのパスと名前
        (たとえば、<em>c:\php\php.exe</em>) を入力します。
       </p>
      </li>
      <li class="listitem">
       <p class="para">
        「Save」アイコンを押します。
       </p>
      </li>
      <li class="listitem">
       <p class="para">
        変更点を反映するためにサーバーを再起動します。
       </p>
      </li>
     </ul>
    </p>
   </div>



   



<div class="sect2" id="install.windows.legacy.building">
 <h3 class="title">ソースからのビルド</h3>
 <p class="para">
  この章では、Windows 上でマイクロソフトのツールを用いて PHP をソースから
  コンパイルする方法を説明します。PHP を cygwin でコンパイルする場合は
  <a href="install.unix.html" class="xref">Unix システムへのインストール</a> を参照ください。
 </p>
 <p class="para">
  Wiki のドキュメント
  <a href="http://wiki.php.net/internals/windows/stepbystepbuild" class="link external">&raquo;&nbsp;http://wiki.php.net/internals/windows/stepbystepbuild</a>
  を参照ください。
 </p>
</div>



   



   <div class="sect2" id="install.windows.legacy.extensions">
    <h3 class="title">Windows 用 PHP 拡張モジュール</h3>
    <p class="para">
     Windows に PHP を インストールし、Web サーバーの設定ができたら、
     次は PHP 拡張モジュールを使うための設定です。
     <var class="filename">php.ini</var> を使って
     PHP が起動時にロードする拡張モジュールを設定することができます。
     もしくは、スクリプトの中で <span class="function"><a href="function.dl.html" class="function">dl()</a></span> 関数を使用することにより、
     拡張モジュールを動的にロードすることも可能です。
    </p>
    <p class="para">
     PHP 拡張モジュールの DLL には、ファイル名の前に &#039;php_&#039; が付いています。
    </p>
    <p class="para">
     Windows 版の PHP には、多くの拡張モジュールが
     <em class="emphasis">組み込まれています</em>。これらの関数を使用する際には、
     追加の DLL ファイルや
     <a href="ini.core.html#ini.extension" class="link">extension</a>
     ディレクティブの設定は<em class="emphasis">不要</em>です。
     追加の DLL が必要となる (あるいはかつて必要だった) 拡張モジュールについては、
     Windows 版
     <a href="install.windows.legacy.index.html#install.windows.legacy.extensions.overview" class="link">PHP 拡張モジュール</a>
     の表にまとめてあります。以下にあげられている拡張モジュールは、すでに
     PHP に組み込まれています (PHP 5.0.4 時点):
     <a href="book.bc.html" class="link">BCMath</a>,
     <a href="book.calendar.html" class="link">Caledar</a>,
     <a href="book.com.html" class="link">COM</a>,
     <a href="book.ctype.html" class="link">Ctype</a>,
     <a href="book.dom.html" class="link">DOM</a>,
     <a href="book.ftp.html" class="link">FTP</a>,
     <a href="book.libxml.html" class="link">LibXML</a>,
     <a href="book.iconv.html" class="link">Iconv</a>,
     <a href="book.uodbc.html" class="link">ODBC</a>,
     <a href="book.pcre.html" class="link">PCRE</a>,
     <a href="book.session.html" class="link">Session</a>,
     <a href="book.simplexml.html" class="link">SimpleXML</a>,
     <a href="book.spl.html" class="link">SPL</a>,
     <a href="book.sqlite.html" class="link">SQLite</a>,
     <a href="book.wddx.html" class="link">WDDX</a>,
     <a href="book.xml.html" class="link">XML</a> そして
     <a href="book.zlib.html" class="link">Zlib</a>.
    </p>
    <p class="para">
     <em>PHP</em> が拡張モジュールを探すデフォルトの場所は
     <var class="filename">C:\php5</var> です。
     変更するには <var class="filename">php.ini</var> ファイルを編集してください。
     <ul class="itemizedlist">
      <li class="listitem">
       <p class="para">
        <a href="ini.core.html#ini.extension-dir" class="link">extension_dir</a> を拡張モジュール
        があるフォルダに変更する必要があります。
        <var class="filename">php_*.dll</var>ファイルをそこに置いてください。
        例えば次のようになります。
        <div class="informalexample">
         <div class="example-contents">
<div class="inicode"><pre class="inicode">extension_dir = c:\php\extensions</pre>
</div>
         </div>

        </div>
       </p>
      </li>
     <li class="listitem">
      <p class="para">
       <var class="filename">php.ini</var> には、多くの拡張モジュール名がコメントアウトされた状態で記載済みです。
       それらの拡張モジュールを有効にするには、<var class="filename">php.ini</var> 上の 
       <em>extension=php_*.dll</em>
       の行をアンコメント（行頭の ; を削除する）してください。
       <div class="example" id="example-31">
        <p><strong>例23 Windows 版の PHP で <a href="book.bzip2.html" class="link">Bzip2</a> 拡張モジュールを有効にする</strong></p>
         <div class="example-contents">
<div class="inicode"><pre class="inicode">// この行を以下から
;extension=php_bz2.dll

// このように変更する
extension=php_bz2.dll</pre>
</div>
         </div>

        </div>      
       </p>
     </li>
      <li class="listitem">
       <p class="para">
        拡張モジュールによっては、その動作に外部 DLL が必要な場合があります。
        配布パッケージには、一部の外部 DLL がバンドルされています。
        親フォルダを参照ください。ただし、必要な外部 DLL
        がバンドルされていないモジュールもあり、たとえば、Oracle モジュール
        (<var class="filename">php_oci8.dll</var>) は、非バンドルの DLL を必要とします。
        また、忘れずに <var class="filename">C:\php</var> をシステムパスに
        追加してください（その方法は、別途 <a href="faq.installation.html#faq.installation.addtopath" class="link">FAQ</a> に記載されています。）
       </p>
     </li>
     <li class="listitem">
      <p class="para">
       これらの DLLs の中には、PHP の配布ファイルに含まれていないものもあります。
       詳細は、それぞれの拡張モジュールのドキュメントを参照ください。
       また、<acronym title="PHP Extension and Application Repository">PECL</acronym> についての詳細は、マニュアルの
       <a href="install.pecl.html" class="link">PECL 拡張モジュールのインストール</a>
       という節を参照ください。多くの PHP 拡張モジュールが
       <acronym title="PHP Extension and Application Repository">PECL</acronym> に移行しつつあり、これらは
       <a href="install.pecl.downloads.html" class="link">個別にダウンロード</a>
       しなければなりません。
      </p>
     </li>
    </ul>
   <blockquote class="note"><p><strong class="note">注意</strong>: 
    <span class="simpara">
     PHP をサーバーモジュールとして実行している場合は、Webサーバーを再起動しないと、
     <var class="filename">php.ini</var> の設定が反映されません。Web サーバーの再起動を忘れずに行ってください。
    </span>
   </p></blockquote>
   </p>

   <p class="para">
    以下の表は、使用可能な拡張モジュールと
    それらの実行に別途必要な DLL のリストです。
    <table id="install.windows.legacy.extensions.overview" class="doctable table">
     <caption><strong>PHP 拡張モジュール</strong></caption>
     
      <thead>
       <tr>
        <th>拡張モジュール</th>
        <th>説明</th>
        <th>備考</th>
       </tr>

      </thead>

      <tbody class="tbody">
  <tr>
   <td>php_bz2.dll</td>
   <td><a href="book.bzip2.html" class="link">bzip2</a> 圧縮関数</td>
   <td class="empty">&nbsp;</td>
  </tr>

  <tr>
   <td>php_calendar.dll</td>
   <td><a href="book.calendar.html" class="link">カレンダー</a> 関数</td>
   <td class="empty">&nbsp;</td>
  </tr>

  <tr>
   <td>php_crack.dll</td>
   <td><a href="book.crack.html" class="link">Crack</a> 関数</td>
   <td class="empty">&nbsp;</td>
  </tr>

  <tr>
   <td>php_ctype.dll</td>
   <td><a href="book.ctype.html" class="link">文字型(ctype)</a> 関数</td>
   <td class="empty">&nbsp;</td>
  </tr>

  <tr>
   <td>php_curl.dll</td>
   <td><a href="book.curl.html" class="link">CURL</a>, Client URL Library 関数</td>
   <td><var class="filename">libeay32.dll</var> および
   <var class="filename">ssleay32.dll</var> が必要 （バンドル）</td>
  </tr>

  <tr>
   <td>php_dba.dll</td>
   <td><a href="book.dba.html" class="link">DBA</a>: (dbm 型の) データベース・アブストラクション レイヤー関数</td>
   <td class="empty">&nbsp;</td>
  </tr>

  <tr>
   <td>php_dbase.dll</td>
   <td><a href="book.dbase.html" class="link">dBase</a> 関数</td>
   <td class="empty">&nbsp;</td>
  </tr>

  <tr>
   <td>php_dbx.dll</td>
   <td><a href="book.dbx.html" class="link">dbx</a> 関数</td>
   <td class="empty">&nbsp;</td>
  </tr>

  <tr>
   <td>php_exif.dll</td>
   <td><a href="book.exif.html" class="link">EXIF</a> 関数</td>
   <td>
    <a href="book.mbstring.html" class="link">php_mbstring.dll</a>。<var class="filename">php.ini</var> で
    <var class="filename">php_exif.dll</var> は 
    <var class="filename">php_mbstring.dll</var> の後で読み込まれる必要がある。
   </td>
  </tr>

  <tr>
   <td>php_fbsql.dll</td>
   <td><a href="book.fbsql.html" class="link">FrontBase</a> 関数</td>
   <td class="empty">&nbsp;</td>
  </tr>

  <tr>
   <td>php_fdf.dll</td>
   <td><a href="book.fdf.html" class="link">FDF</a>: Forms Data Format 関数</td>
   <td><var class="filename">fdftk.dll</var> が必要 （バンドル）</td>
  </tr>

  <tr>
   <td>php_filepro.dll</td>
   <td><a href="book.filepro.html" class="link">filePro</a> 関数</td>
   <td>読み込みのみ</td>
  </tr>

  <tr>
   <td>php_ftp.dll</td>
   <td><a href="book.ftp.html" class="link">FTP</a> 関数</td>
   <td class="empty">&nbsp;</td>
  </tr>

  <tr>
   <td>php_gd2.dll</td>
   <td><a href="book.image.html" class="link">イメージ</a> 関数 (GD2 ライブラリ)</td>
   <td>GD2</td>
  </tr>

  <tr>
   <td>php_gettext.dll</td>
   <td><a href="book.gettext.html" class="link">Gettext</a> 関数</td>
   <td>
    PHP &lt;= 4.2.0 では <var class="filename">gnu_gettext.dll</var> が必要 （バンドル）, 
    PHP &gt;= 4.2.3 では <var class="filename">libintl-1.dll</var> および
    <var class="filename">iconv.dll</var>  が必要（バンドル）
   </td>
  </tr>

  <tr>
   <td>php_hyperwave.dll</td>
   <td>HyperWave 関数</td>
   <td class="empty">&nbsp;</td>
  </tr>

  <tr>
   <td>php_iconv.dll</td>
   <td><a href="book.iconv.html" class="link">ICONV</a> 関数</td>
   <td><var class="filename">iconv-1.3.dll</var> が必要（バンドル）、
   <var class="filename">iconv.dll</var></td>
  </tr>

  <tr>
   <td>php_ifx.dll</td>
   <td><a href="book.ifx.html" class="link">Informix</a> 関数</td>
   <td>Informix ライブラリが必要</td>
  </tr>

  <tr>
   <td>php_iisfunc.dll</td>
   <td>IIS management 関数</td>
   <td class="empty">&nbsp;</td>
  </tr>

  <tr>
   <td>php_imap.dll</td>
   <td><a href="book.imap.html" class="link">IMAP,POP3,NNTP</a> 関数</td>
   <td class="empty">&nbsp;</td>
  </tr>

  <tr>
   <td>php_ingres.dll</td>
   <td><a href="book.ingres.html" class="link">Ingres</a> 関数</td>
   <td>Ingres ライブラリが必要</td>
  </tr>

  <tr>
   <td>php_interbase.dll</td>
   <td><a href="book.ibase.html" class="link">InterBase</a> 関数</td>
   <td><var class="filename">gds32.dll</var> が必要（バンドル）</td>
  </tr>

  <tr>
   <td>php_ldap.dll</td>
   <td><a href="book.ldap.html" class="link">LDAP</a> 関数</td>
   <td>
    <var class="filename">libeay32.dll</var> と
    <var class="filename">ssleay32.dll</var> が必要（バンドル）
   </td>
  </tr>

  <tr>
   <td>php_mbstring.dll</td>
   <td><a href="book.mbstring.html" class="link">マルチバイト文字列</a> 関数</td>
   <td class="empty">&nbsp;</td>
  </tr>

  <tr>
   <td>php_mcrypt.dll</td>
   <td><a href="book.mcrypt.html" class="link">Mcrypt 暗号化</a> 関数</td>
   <td><var class="filename">libmcrypt.dll</var> が必要</td>
  </tr>

  <tr>
   <td>php_mhash.dll</td>
   <td><a href="book.mhash.html" class="link">Mhash</a> 関数</td>
   <td><var class="filename">libmhash.dll</var> が必要（バンドル）</td>
  </tr>

  <tr>
   <td>php_mime_magic.dll</td>
   <td><a href="book.mime-magic.html" class="link">Mimetype</a> 関数</td>
   <td><var class="filename">magic.mime</var> が必要（バンドル）</td>
  </tr>

  <tr>
   <td>php_ming.dll</td>
   <td><a href="book.ming.html" class="link">Ming</a> 関数 (Flash 用)</td>
   <td class="empty">&nbsp;</td>
  </tr>

  <tr>
   <td>php_msql.dll</td>
   <td><a href="book.msql.html" class="link">mSQL</a> 関数</td>
   <td><var class="filename">msql.dll</var> が必要（バンドル）</td>
  </tr>

  <tr>
   <td>php_mssql.dll</td>
   <td><a href="book.mssql.html" class="link">MSSQL</a> 関数</td>
   <td><var class="filename">ntwdblib.dll</var> が必要（バンドル）</td>
  </tr>

  <tr>
   <td>php_mysql.dll</td>
   <td><a href="book.mysql.html" class="link">MySQL</a> 関数</td>
   <td><var class="filename">libmysql.dll</var>
    が必要（バンドル）</td>
  </tr>

  <tr>
   <td>php_mysqli.dll</td>
   <td><a href="book.mysqli.html" class="link">MySQLi</a> 関数</td>
   <td><var class="filename">libmysql.dll</var>
    (PHP &lt;= 5.0.2 では <var class="filename">libmysqli.dll</var>) が必要（バンドル）</td>
  </tr>

  <tr>
   <td>php_oci8.dll</td>
   <td><a href="book.oci8.html" class="link">Oracle 8</a> 関数</td>
   <td>Oracle 8.1+ クライアントライブラリが必要</td>
  </tr>

  <tr>
   <td>php_openssl.dll</td>
   <td><a href="book.openssl.html" class="link">OpenSSL</a> 関数</td>
   <td><var class="filename">libeay32.dll</var> が必要（バンドル）</td>
  </tr>

  <tr>
   <td>php_pdf.dll</td>
   <td><a href="book.pdf.html" class="link">PDF</a> 関数</td>
   <td class="empty">&nbsp;</td>
  </tr>

  <tr>
   <td>php_pgsql.dll</td>
   <td><a href="book.pgsql.html" class="link">PostgreSQL</a> 関数</td>
   <td class="empty">&nbsp;</td>
  </tr>

  <tr>
   <td>php_shmop.dll</td>
   <td><a href="book.shmop.html" class="link">共有メモリ</a> 関数 (shmop)</td>
   <td class="empty">&nbsp;</td>
  </tr>

  <tr>
   <td>php_snmp.dll</td>
   <td><a href="book.snmp.html" class="link">SNMP</a> 関数</td>
   <td>NT のみ</td>
  </tr>

  <tr>
   <td>php_soap.dll</td>
   <td><a href="book.soap.html" class="link">SOAP</a> 関数</td>
   <td class="empty">&nbsp;</td>
  </tr>

  <tr>
   <td>php_sockets.dll</td>
   <td><a href="book.sockets.html" class="link">ソケット</a> 関数</td>
   <td class="empty">&nbsp;</td>
  </tr>

  <tr>
   <td>php_sybase_ct.dll</td>
   <td><a href="book.sybase.html" class="link">Sybase</a> 関数</td>
   <td>Sybase クライアントライブラリが必要</td>
  </tr>

  <tr>
   <td>php_tidy.dll</td>
   <td><a href="book.tidy.html" class="link">Tidy</a> 関数</td>
   <td class="empty">&nbsp;</td>
  </tr>

  <tr>
   <td>php_tokenizer.dll</td>
   <td><a href="book.tokenizer.html" class="link">Tokenizer</a> 関数</td>
   <td class="empty">&nbsp;</td>
  </tr>

  <tr>
   <td>php_w32api.dll</td>
   <td>W32api 関数</td>
   <td class="empty">&nbsp;</td>
  </tr>

  <tr>
   <td>php_xmlrpc.dll</td>
   <td><a href="book.xmlrpc.html" class="link">XML-RPC</a> 関数</td>
   <td><var class="filename">iconv.dll</var> が必要（バンドル）</td>
  </tr>

  <tr>
   <td>php_xslt.dll</td>
   <td>XSLT 関数</td>
   <td>
    <var class="filename">sablot.dll</var>, <var class="filename">expat.dll</var> および
    <var class="filename">iconv.dll</var> が必要（バンドル）
   </td>
  </tr>

  <tr>
   <td>php_yaz.dll</td>
   <td><a href="book.yaz.html" class="link">YAZ</a> 関数</td>
   <td><var class="filename">yaz.dll</var> が必要（バンドル）</td>
  </tr>

  <tr>
   <td>php_zip.dll</td>
   <td><a href="book.zip.html" class="link">Zip ファイル</a> 関数</td>
   <td>読込のみ</td>
  </tr>

  <tr>
   <td>php_zlib.dll</td>
   <td><a href="book.zlib.html" class="link">ZLib</a> 圧縮関数</td>
   <td class="empty">&nbsp;</td>
  </tr>

       </tbody>
      
     </table>

    </p>
   </div>



   


   <div class="sect2" id="install.windows.legacy.commandline">
    <h3 class="title">Microsoft Windows のコマンドラインでの PHP</h3>
    <p class="para">
     この節では、PHP を Windows のコマンドラインで実行するときの注意点やヒントを説明します。 
    </p>
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <p class="para">
      まず最初に <a href="install.windows.legacy.index.html#install.windows.legacy.manual" class="link">
      手動でのインストールの手順</a> を読みましょう!
     </p>
    </p></blockquote>
    <p class="para">
     特に Windows に手を加えなくても、PHP をコマンドラインから実行することはできます。
     <div class="example-contents screen">
<div class="cdata"><pre>
C:\PHP5\php.exe -f &quot;C:\PHP Scripts\script.php&quot; -- -arg1 -arg2 -arg3
</pre></div>     
     </div>
    </p>

    <p class="para">
     しかし、次の手順に従えば、さらにシンプルに実行することができます。
     この中にはすでに実行済みのものがあるかもしれませんが、順を追って進めていくために
     もう一度ここで説明しておきます。
      
     
     <ul class="itemizedlist">
      
      <blockquote class="note"><p><strong class="note">注意</strong>: 
       <p class="para">
        <span class="envar">PATH</span> と <span class="envar">PATHEXT</span> は
        Windows で重要な働きをするシステム変数です。
        既存の変数の値を上書きしないように注意しましょう。あくまでも追記するだけにします。
       </p>
      </p></blockquote>

      <li class="listitem">
       <p class="para">
        PHP の実行ファイル (<var class="filename">php.exe</var>、
        <var class="filename">php-win.exe</var> あるいは <var class="filename">php-cli.exe</var>。
        PHP のバージョンや設定によって変わります)
        がある場所を環境変数 <span class="envar">PATH</span> の最後に追加します。
        PHP のディレクトリを <span class="envar">PATH</span> に追加する方法は、<a href="faq.installation.html#faq.installation.addtopath" class="link">FAQ の項目</a>
        を参照ください。
       </p>
      </li>

      <li class="listitem">
       <p class="para">
        拡張子 <em>.PHP</em> を、環境変数
        <var class="varname"><var class="varname">PATHEXT</var></var> の最後に追加します。これは、環境変数
        <span class="envar">PATH</span> の変更と同時に行うこともできます。
        <a href="faq.installation.html#faq.installation.addtopath" class="link">FAQ</a>
        に書かれている手順に従いましょう。ただし、環境変数
        <span class="envar">PATH</span> の部分は
        <var class="varname"><var class="varname">PATHEXT</var></var> に変更します。
        <blockquote class="note"><p><strong class="note">注意</strong>: 
         <p class="para">
          <em>.PHP</em> をどの位置に書くかによって、
          ファイル名がマッチしたときに実行されるスクリプトあるいはプログラムが決まります。
          たとえば <em>.PHP</em> を
          <em>.BAT</em> より前に書くと、
          同じ名前のバッチファイルがあってもスクリプトのほうを優先して実行します。
         </p>
        </p></blockquote>
       </p>
      </li>

      <li class="listitem">
       <p class="para">
        拡張子 <em>.PHP</em> をファイル形式と関連づけます。
        これは、次のコマンドで行います。
        <div class="example-contents screen">
<div class="cdata"><pre>
assoc .php=phpfile
</pre></div>     
        </div>
       </p>
      </li>

      <li class="listitem">
       <p class="para">
        ファイル形式 <em>phpfile</em> を適切な PHP 実行ファイルと関連づけます。
        これは、次のコマンドで行います。
        <div class="example-contents screen">
<div class="cdata"><pre>
ftype phpfile=&quot;C:\PHP5\php.exe&quot; -f &quot;%1&quot; -- %~2
</pre></div>     
        </div>
       </p>
      </li>

     </ul>
    </p>

    <p class="para">
     このようにしておくと、どのディレクトリにあるスクリプトを実行するときにも
     PHP 実行ファイルのパスや拡張子 <em>.PHP</em> をタイプしなくて済むようになります。
     また、スクリプトに渡すパラメータを指定することもできます。
    </p>

    <p class="para">
     次の例は、レジストリの変更の一部を示したものです。これらは手動で行うこともできます。
     <div class="example" id="example-32">
      <p><strong>例24 レジストリの変更</strong></p>
      <div class="example-contents screen">
<div class="cdata"><pre>
Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\.php]
@=&quot;phpfile&quot;
&quot;Content Type&quot;=&quot;application/php&quot;

[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\phpfile]
@=&quot;PHP Script&quot;
&quot;EditFlags&quot;=dword:00000000
&quot;BrowserFlags&quot;=dword:00000008
&quot;AlwaysShowExt&quot;=&quot;&quot;

[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\phpfile\DefaultIcon]
@=&quot;C:\\PHP5\\php-win.exe,0&quot;

[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\phpfile\shell]
@=&quot;Open&quot;

[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\phpfile\shell\Open]
@=&quot;&amp;Open&quot;

[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\phpfile\shell\Open\command]
@=&quot;\&quot;C:\\PHP5\\php.exe\&quot; -f \&quot;%1\&quot; -- %~2&quot;
</pre></div>
      </div>
     </div>
    </p>

    <p class="para">
     これらの変更をすれば、同じコマンドを次のように書くことができます。
     <div class="example-contents screen">
<div class="cdata"><pre>
&quot;C:\PHP Scripts\script&quot; -arg1 -arg2 -arg3
</pre></div>
     </div>
     また、<em>&quot;C:\PHP Scripts&quot;</em> が環境変数
     <span class="envar">PATH</span> に含まれていれば、次のように書くこともできます。
     <div class="example-contents screen">
<div class="cdata"><pre>
script -arg1 -arg2 -arg3
</pre></div>
     </div>
    </p>

    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <p class="para">
      これらのテクニックを使って PHP スクリプトをコマンドラインフィルタとして使おうとすると、
      ちょっとした問題が発生します。「コマンドラインフィルタとして使う」とは、たとえば 
      <div class="example-contents screen">
<div class="cdata"><pre>
dir | &quot;C:\PHP Scripts\script&quot; -arg1 -arg2 -arg3
</pre></div>
      </div>
      あるいは
      <div class="example-contents screen">
<div class="cdata"><pre>
dir | script -arg1 -arg2 -arg3
</pre></div>
      </div>
      のように使うということです。
      このようにすると、スクリプトがハングして何も出力されなくなります。
      これをうまく動作させるには、さらにレジストリを変更しなければなりません。
      <div class="example-contents screen">
<div class="cdata"><pre>
Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\policies\Explorer]
&quot;InheritConsoleHandles&quot;=dword:00000001
</pre></div>
      </div>
      この件に関する詳細な情報は <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;321788" class="link external">&raquo;&nbsp;Microsoft
      Knowledgebase Article : 321788</a> を参照ください。
      Windows 10 ではこの設定が変更されたようです。Windows 10 をインストールしたデフォルトの状態で、
      コンソールのハンドルが自動的に引き継がれるようになります。この件に関しては、
      <a href="https://social.msdn.microsoft.com/Forums/en-US/f19d740d-21c8-4dc2-a9ab-d5c0527e932b/nasty-file-association-regression-bug-in-windows-10-console?forum=windowssdk" class="link external">&raquo;&nbsp;
      Microsoft のフォーラムへの投稿</a> に説明があります。
     </p>
    </p></blockquote>
   </div>



  </div><hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="install.windows.troubleshooting.html">Windows 上での PHP のトラブルシューティング</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="install.cloud.html">クラウドコンピューティングプラットフォームへのインストール</a></div>
 <div class="up"><a href="install.windows.html">Windows システムへのインストール</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
